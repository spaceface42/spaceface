{
  "version": 3,
  "sources": ["../../src/system/bin/EventBus.ts", "../../src/system/bin/EventWatcher.ts", "../../src/system/features/bin/timing.ts", "../../src/system/types/events.ts", "../../src/system/bin/InactivityWatcher.ts", "../../src/system/bin/EventLogger.ts", "../../src/system/bin/EventBinder.ts", "../../src/system/bin/PartialLoader.ts", "../../src/system/bin/PartialFetcher.ts", "../../src/system/features/bin/AsyncImageLoader.ts", "../../src/system/features/bin/AnimationLoop.ts", "../../src/system/features/bin/AnimationPolicy.ts", "../../src/system/features/SlidePlayer/SlidePlayer.ts", "../../src/system/features/bin/math.ts", "../../src/system/features/FloatingImages/FloatingImage.ts", "../../src/system/features/bin/PerformanceMonitor.ts", "../../src/system/features/bin/ResizeManager.ts", "../../src/system/features/FloatingImages/FloatingImagesManager.ts", "../../src/system/features/Screensaver/ScreensaverController.ts", "../../src/system/bin/DomReadyPromise.ts", "../../src/app/symlink.ts", "../../src/system/bin/generateId.ts", "../../src/app/spaceface.core.ts", "../../src/app/main.ts"],
  "sourcesContent": ["export const VERSION = '2.0.0' as const;\n\nimport {\n    UnsubscribeFn,\n    ListenerInterface,\n    AnyListenerInterface,\n    EventBusInterface\n} from '../types/bin.js';\nimport type { SpacefaceEventMap } from '../types/events.js';\n\nexport class EventBus<TEvents extends Record<string, unknown> = Record<string, unknown>> implements EventBusInterface<TEvents> {\n    private listeners: Map<string, ListenerInterface[]> = new Map();\n    private anyListeners: AnyListenerInterface[] = [];\n    private onceWrappers = new WeakMap<Function, Function>();\n    private emittingError = false;\n    private debugMode = false; // Debug mode flag\n\n    /**\n     * Enable or disable debug mode.\n     * @param enable Set to true to enable debug mode, false to disable.\n     */\n    setDebugMode(enable: boolean): void {\n        this.debugMode = enable;\n        if (this.debugMode) {\n            console.debug(\"[EventBus] Debug mode enabled\");\n        }\n    }\n\n    /**\n     * Register an event listener.\n     * @param event The event name.\n     * @param fn The listener function.\n     * @param priority The priority of the listener.\n     * @returns A function to unsubscribe the listener.\n     */\n    on<K extends keyof TEvents>(event: K, fn: (payload: TEvents[K]) => any, priority?: number): UnsubscribeFn;\n    on<T = any>(event: string, fn: (payload: T) => any, priority?: number): UnsubscribeFn;\n    on<T = any>(event: string, fn: (payload: T) => any, priority = 0): UnsubscribeFn {\n        const list = this.listeners.get(event) ?? [];\n        const listener: ListenerInterface = { fn, priority };\n        let i = list.length;\n        while (i > 0 && list[i - 1].priority < priority) i--;\n        list.splice(i, 0, listener);\n        this.listeners.set(event, list);\n\n        if (this.debugMode) {\n            console.debug(`[EventBus] Listener added for event: ${event}`, { priority });\n        }\n\n        return () => this.off(event, fn);\n    }\n\n    /**\n     * Register a one-time event listener.\n     * @param event The event name.\n     * @param fn The listener function.\n     * @param priority The priority of the listener.\n     * @returns A function to unsubscribe the listener.\n     */\n    once<K extends keyof TEvents>(event: K, fn: (payload: TEvents[K]) => any, priority?: number): UnsubscribeFn;\n    once<T = any>(event: string, fn: (payload: T) => any, priority?: number): UnsubscribeFn;\n    once<T = any>(event: string, fn: (payload: T) => any, priority = 0): UnsubscribeFn {\n        const wrapper = (payload: T) => {\n            this.off(event, wrapper);\n            fn(payload);\n        };\n        this.onceWrappers.set(fn, wrapper);\n        this.on(event, wrapper, priority);\n        return () => this.off(event, fn);\n    }\n\n    /**\n     * Remove an event listener.\n     * @param event The event name.\n     * @param fn The listener function to remove.\n     */\n    off(event: string, fn: Function): void {\n        const list = this.listeners.get(event);\n        if (!list) return;\n        const wrapper = this.onceWrappers.get(fn) ?? fn;\n        this.listeners.set(event, list.filter(l => l.fn !== wrapper));\n\n        if (this.debugMode) {\n            console.debug(`[EventBus] Listener removed for event: ${event}`);\n        }\n    }\n\n    /**\n     * Check if there are listeners for a specific event.\n     * @param event The event name.\n     * @returns True if there are listeners, false otherwise.\n     */\n    hasListeners(event: string): boolean {\n        return event === \"any\"\n            ? this.anyListeners.length > 0\n            : (this.listeners.get(event)?.length ?? 0) > 0;\n    }\n\n    /**\n     * Register a listener for any event.\n     * @param fn The listener function.\n     * @param priority The priority of the listener.\n     * @returns A function to unsubscribe the listener.\n     */\n    onAny(fn: (event: keyof TEvents & string, payload: TEvents[keyof TEvents]) => any, priority = 0): UnsubscribeFn {\n        const listener: AnyListenerInterface = { fn, priority };\n        let i = this.anyListeners.length;\n        while (i > 0 && this.anyListeners[i - 1].priority < priority) i--;\n        this.anyListeners.splice(i, 0, listener);\n\n        if (this.debugMode) {\n            console.debug(\"[EventBus] Listener added for any event\", { priority });\n        }\n\n        return () => this.offAny(fn);\n    }\n\n    /**\n     * Remove a listener for any event.\n     * @param fn The listener function to remove.\n     */\n    offAny(fn: Function): void {\n        this.anyListeners = this.anyListeners.filter(l => l.fn !== fn);\n\n        if (this.debugMode) {\n            console.debug(\"[EventBus] Listener removed for any event\");\n        }\n    }\n\n    /**\n     * Emit an event to all registered listeners.\n     * @param event The event name.\n     * @param payload The event payload.\n     */\n    emit<K extends keyof TEvents>(event: K, payload?: TEvents[K]): void;\n    emit<T = any>(event: string, payload?: T): void;\n    emit<T = any>(event: string, payload?: T): void {\n        if (!event) {\n            this._handleError(\"Event name is undefined or empty\", new Error());\n            return;\n        }\n\n        if (this.debugMode) {\n            console.debug(`[EventBus] Emitting event: ${event}`, payload);\n        }\n\n        const list = [...(this.listeners.get(event) ?? [])];\n        for (const l of list) {\n            try {\n                l.fn(payload);\n            } catch (err) {\n                this._handleError(`Error in listener for \"${event}\"`, err);\n            }\n        }\n\n        const anyList = [...this.anyListeners];\n        for (const l of anyList) {\n            try {\n                l.fn(event, payload);\n            } catch (err) {\n                this._handleError(`Error in any-listener for \"${event}\"`, err);\n            }\n        }\n    }\n\n    /**\n     * Emit an event asynchronously to all registered listeners.\n     * @param event The event name.\n     * @param payload The event payload.\n     * @returns A promise that resolves with the results of all listeners.\n     */\n    async emitAsync<K extends keyof TEvents>(event: K, payload?: TEvents[K]): Promise<any[]>;\n    async emitAsync<T = any>(event: string, payload?: T): Promise<any[]>;\n    async emitAsync<T = any>(event: string, payload?: T): Promise<any[]> {\n        if (!event) {\n            this._handleError(\"Event name is undefined or empty\", new Error());\n            return [];\n        }\n\n        const results: any[] = [];\n        const list = [...(this.listeners.get(event) ?? [])];\n        for (const l of list) {\n            try {\n                results.push(await l.fn(payload));\n            } catch (err) {\n                this._handleError(`Async error in listener for \"${event}\"`, err);\n            }\n        }\n\n        const anyList = [...this.anyListeners];\n        for (const l of anyList) {\n            try {\n                results.push(await l.fn(event, payload));\n            } catch (err) {\n                this._handleError(`Async error in any-listener for \"${event}\"`, err);\n            }\n        }\n\n        return results;\n    }\n\n    /**\n     * Remove all listeners for a specific event or all events.\n     * @param event The event name. If omitted, all listeners are removed.\n     */\n    removeAllListeners(event?: string): void {\n        if (!event) {\n            this.listeners.clear();\n            this.anyListeners = [];\n        } else if (event === \"any\") {\n            this.anyListeners = [];\n        } else {\n            this.listeners.delete(event);\n        }\n\n        if (this.debugMode) {\n            console.debug(`[EventBus] All listeners removed for event: ${event ?? \"all\"}`);\n        }\n    }\n\n    /**\n     * Get the number of listeners for a specific event.\n     * @param event The event name.\n     * @returns The number of listeners.\n     */\n    listenerCount(event: string): number {\n        return event === \"any\"\n            ? this.anyListeners.length\n            : (this.listeners.get(event)?.length ?? 0);\n    }\n\n    /**\n     * Get the names of all events with registered listeners.\n     * @returns An array of event names.\n     */\n    eventNames(): string[] {\n        return Array.from(this.listeners.keys()).filter(event => (this.listeners.get(event)?.length ?? 0) > 0);\n    }\n\n    /**\n     * Get all listeners for a specific event.\n     * @param event The event name.\n     * @returns An array of listener functions.\n     */\n    getListeners(event: string): Function[] {\n        return event === \"any\"\n            ? this.anyListeners.map(l => l.fn)\n            : (this.listeners.get(event) ?? []).map(l => l.fn);\n    }\n\n    /**\n     * Handle errors during event emission.\n     * @param message The error message.\n     * @param error The error object.\n     */\n    private _handleError(message: string, error: any): void {\n        if (this.emittingError) return;\n        this.emittingError = true;\n\n        console.error(`[EventBus] ${message}`, error);\n\n        this.emittingError = false;\n    }\n}\n\nexport const eventBus = new EventBus<SpacefaceEventMap>();\n", "// src/spaceface/system/bin/EventWatcher.ts\nexport const VERSION = '2.0.0' as const;\n\nimport { eventBus } from \"./EventBus.js\";\nimport type { LogPayload } from \"../types/bin.js\";\n\nexport abstract class EventWatcher {\n    protected readonly target: EventTarget;\n    protected readonly debug: boolean;\n    protected destroyed = false;\n\n    // DOM listeners storage (use Set to avoid duplicates)\n    private domListeners = new Set<{\n        type: string;\n        handler: EventListenerOrEventListenerObject;\n        options?: boolean | AddEventListenerOptions;\n    }>();\n\n    // To deduplicate log:debug messages\n    private loggedMessages = new Set<string>();\n\n    constructor(target: EventTarget, debug: boolean = false) {\n        // Use duck-typing so code runs in environments where EventTarget isn't constructible\n        if (!target || typeof (target as any).addEventListener !== \"function\" || typeof (target as any).removeEventListener !== \"function\") {\n            throw new Error(`${this.constructor.name}: target must be a valid EventTarget.`);\n        }\n        this.target = target;\n        this.debug = debug;\n    }\n\n    /**\n     * Centralized logging with support for debug mode.\n     */\n    protected log(levelOrMessage: 'debug' | 'info' | 'warn' | 'error' | string, messageOrData?: unknown, data?: unknown) {\n        // If first arg is a recognized level and second arg is a string -> new form\n        const levels = ['debug', 'info', 'warn', 'error'];\n        if (typeof levelOrMessage === 'string' && levels.includes(levelOrMessage) && typeof messageOrData === 'string') {\n            const level = levelOrMessage as 'debug' | 'info' | 'warn' | 'error';\n            const message = messageOrData as string;\n            const payload = data;\n            if (!this.debug && level === 'debug') return;\n            try {\n                const logPayload: LogPayload = {\n                    scope: this.constructor.name,\n                    level,\n                    message,\n                    data: payload,\n                    time: Date.now(),\n                };\n                eventBus.emit(\"log\", logPayload);\n            } catch (_) { /* ignore eventBus errors */ }\n            if (this.debug) {\n                const method = { debug: 'debug', info: 'info', warn: 'warn', error: 'error' }[level] ?? 'log';\n                (console as any)[method](`[${this.constructor.name}] [${level.toUpperCase()}]`, message, payload);\n            }\n            return;\n        }\n\n        // Backward-compatible form: log(message, data?)\n        const message = levelOrMessage as string;\n        const payload = messageOrData;\n        if (!this.debug) return;\n        let logKey: string;\n        try {\n            logKey = `${message}-${JSON.stringify(payload)}`;\n        } catch {\n            logKey = `${message}-[unserializable]`;\n        }\n        if (!this.loggedMessages.has(logKey)) {\n            this.loggedMessages.add(logKey);\n            try {\n                const sanitizedPayload = payload && typeof payload === 'object' ? JSON.parse(JSON.stringify(payload)) : payload;\n                const logPayload: LogPayload = {\n                    scope: this.constructor.name,\n                    level: 'debug',\n                    message,\n                    data: sanitizedPayload,\n                    time: Date.now(),\n                };\n                eventBus.emit(\"log:debug\", logPayload);\n            } catch (error) {\n                console.warn(\"Failed to log debug event\", { message, payload, error });\n            }\n        }\n        (console as any).debug?.(`[${this.constructor.name}] [DEBUG]`, message, payload);\n    }\n\n    protected checkDestroyed() {\n        if (this.destroyed) {\n            throw new Error(`${this.constructor.name} has been destroyed.`);\n        }\n    }\n\n    public destroy() {\n        if (this.destroyed) return;\n        this.log('info', \"Destroying watcher\");\n        try {\n            this.removeAllDomListeners();\n            this.removeEventListeners();\n        } catch (err) {\n            // ensure we mark destroyed and surface debug info without throwing\n            this.log('error', \"Error while destroying watcher\", err);\n        } finally {\n            this.destroyed = true;\n        }\n    }\n\n    /**\n     * Add a DOM listener and store it for later removal.\n     */\n    protected addDomListener(type: string, handler: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions) {\n        if (this.destroyed) return;\n        this.target.addEventListener(type, handler, options);\n        this.domListeners.add({ type, handler, options });\n        if (this.debug) {\n            this.log('debug', `Added DOM listener`, { type, handler, options });\n        }\n    }\n\n    /**\n     * Remove all stored DOM listeners.\n     */\n    protected removeAllDomListeners() {\n        for (const { type, handler, options } of this.domListeners) {\n            try {\n                this.target.removeEventListener(type, handler, options as any);\n                if (this.debug) {\n                    this.log('debug', `Removed DOM listener`, { type, handler });\n                }\n            } catch (e) {\n                this.log('warn', `Failed to remove DOM listener`, { type, handler, error: e });\n            }\n        }\n        this.domListeners.clear();\n    }\n\n    /** Must be implemented by subclasses */\n    protected abstract addEventListeners(): void;\n    protected abstract removeEventListeners(): void;\n}\n", "// src/spaceface/system/features/bin/timing.ts\n\nexport const VERSION = '2.0.0' as const;\n\n/** Generic type: function with cancel method */\nexport type CancellableFunction<T extends (...args: any[]) => void> = T & { cancel: () => void };\n\n/** Internal helper: manages a timeout with cancel support */\nfunction createTimeout(): { id: number | null; set: (fn: () => void, ms: number) => void; cancel: () => void } {\n  let id: number | null = null;\n\n  return {\n    get id() { return id; },\n    set(fn: () => void, ms: number) {\n      if (id !== null) clearTimeout(id);\n      id = window.setTimeout(() => {\n        id = null;\n        fn();\n      }, ms);\n    },\n    cancel() {\n      if (id !== null) {\n        clearTimeout(id);\n        id = null;\n      }\n    },\n  };\n}\n\n/**\n * Creates a debounced function that delays invoking `func` until after `delay` ms\n * have elapsed since the last call. Includes error handling for invalid inputs.\n *\n * @param func - The function to debounce.\n * @param delay - The number of milliseconds to delay.\n * @param immediate - If `true`, trigger the function on the leading edge.\n * @returns A debounced function with a `cancel` method.\n */\nexport function debounce<T extends (...args: any[]) => void>(\n  func: T,\n  delay = 300,\n  immediate = false\n): CancellableFunction<(...args: Parameters<T>) => void> {\n  if (typeof func !== 'function') {\n    throw new TypeError('Expected a function for debounce');\n  }\n  if (typeof delay !== 'number' || delay < 0) {\n    throw new TypeError('Expected a non-negative number for delay');\n  }\n\n  const timer = createTimeout();\n\n  function debounced(this: ThisParameterType<T>, ...args: Parameters<T>) {\n    const callNow = immediate && timer.id === null;\n\n    timer.set(() => {\n      if (!immediate) func.apply(this, args);\n    }, delay);\n\n    if (callNow) func.apply(this, args);\n  }\n\n  debounced.cancel = () => timer.cancel();\n\n  return debounced;\n}\n\n/**\n * Creates a throttled function that invokes `func` at most once per `delay` ms.\n * Includes error handling for invalid inputs.\n *\n * @param func - The function to throttle.\n * @param delay - The number of milliseconds to throttle calls.\n * @param options - Options to control leading and trailing edge calls.\n * @returns A throttled function with a `cancel` method.\n */\nexport function throttle<T extends (...args: any[]) => void>(\n  func: T,\n  delay = 100,\n  options: { leading?: boolean; trailing?: boolean } = {}\n): CancellableFunction<(...args: Parameters<T>) => void> {\n  if (typeof func !== 'function') {\n    throw new TypeError('Expected a function for throttle');\n  }\n  if (typeof delay !== 'number' || delay < 0) {\n    throw new TypeError('Expected a non-negative number for delay');\n  }\n\n  const { leading = true, trailing = true } = options;\n  let lastCall = 0;\n  let lastArgs: Parameters<T> | null = null;\n  let lastThis: ThisParameterType<T> | null = null;\n  const timer = createTimeout();\n\n  function invoke() {\n    lastCall = leading ? Date.now() : 0;\n    func.apply(lastThis!, lastArgs!);\n    lastArgs = lastThis = null;\n  }\n\n  function throttled(this: ThisParameterType<T>, ...args: Parameters<T>) {\n    const now = Date.now();\n    if (lastCall === 0 && !leading) lastCall = now;\n\n    lastArgs = args;\n    lastThis = this;\n\n    const remaining = delay - (now - lastCall);\n\n    if (remaining <= 0 || remaining > delay) {\n      timer.cancel();\n      invoke();\n    } else if (timer.id === null && trailing) {\n      timer.set(() => {\n        if (trailing && lastArgs) invoke();\n      }, remaining);\n    }\n  }\n\n  throttled.cancel = () => {\n    timer.cancel();\n    lastCall = 0;\n    lastArgs = lastThis = null;\n  };\n\n  return throttled;\n}\n", "import type { LogPayload, PartialEventPayload } from './bin.js';\n\nexport const EVENTS = {\n  LOG: 'log',\n  LOG_DEBUG: 'log:debug',\n  LOG_ERROR: 'log:error',\n  TELEMETRY: 'telemetry',\n  USER_ACTIVE: 'user:active',\n  USER_INACTIVE: 'user:inactive',\n  SCREENSAVER_INITIALIZED: 'screensaver:initialized',\n  SCREENSAVER_SHOWN: 'screensaver:shown',\n  SCREENSAVER_HIDDEN: 'screensaver:hidden',\n  SCREENSAVER_ERROR: 'screensaver:error',\n  SCREENSAVER_LOG: 'screensaver:log',\n  SLIDEPLAYER_LOG: 'slideplayer:log',\n  FLOATING_IMAGES_LOG: 'floatingImages:log',\n  PARTIAL_LOADED: 'partial:loaded',\n  PARTIAL_ERROR: 'partial:error',\n  PARTIAL_LOAD_COMPLETE: 'partial:load:complete',\n  PARTIALS_ALL_LOADED: 'partials:allLoaded',\n} as const;\n\nexport interface TelemetryPayload {\n  type: string;\n  feature?: string;\n  status?: 'success' | 'skipped' | 'error';\n  duration?: string;\n  value?: string;\n  page?: string;\n  error?: unknown;\n}\n\nexport interface UserActivityPayload {\n  lastActiveAt: number;\n  inactivityDelay: number;\n  visible: boolean;\n  inactiveAt?: number;\n}\n\nexport interface ScreensaverVisibilityPayload {\n  targetSelector: string;\n}\n\nexport interface ScreensaverErrorPayload {\n  message: string;\n  error: unknown;\n}\n\nexport interface SpacefaceEventMap {\n  log: LogPayload;\n  'log:debug': LogPayload;\n  'log:error': unknown;\n  telemetry: TelemetryPayload;\n  'user:active': UserActivityPayload;\n  'user:inactive': UserActivityPayload;\n  'screensaver:initialized': string;\n  'screensaver:shown': ScreensaverVisibilityPayload;\n  'screensaver:hidden': ScreensaverVisibilityPayload;\n  'screensaver:error': ScreensaverErrorPayload;\n  'screensaver:log': { level: 'debug' | 'info' | 'warn' | 'error'; message: string; data?: unknown };\n  'slideplayer:log': { level: 'debug' | 'info' | 'warn' | 'error'; message: string; data?: unknown };\n  'floatingImages:log': { level: 'debug' | 'info' | 'warn' | 'error'; message: string; data?: unknown };\n  'partial:loaded': PartialEventPayload;\n  'partial:error': PartialEventPayload;\n  'partial:load:complete': PartialEventPayload;\n  'partials:allLoaded': PartialEventPayload;\n  [event: string]: unknown;\n}\n", "// src/spaceface/system/bin/InactivityWatcher.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport { EventWatcher } from './EventWatcher.js';\nimport { eventBus } from './EventBus.js';\nimport { throttle } from '../features/bin/timing.js';\nimport { EVENTS } from '../types/events.js';\n\nexport interface InactivityWatcherOptionsInterface {\n    inactivityDelay: number;\n    debug?: boolean;\n    target?: EventTarget;\n}\n\nexport class InactivityWatcher extends EventWatcher {\n    private static _instance: InactivityWatcher | null = null;\n\n    private inactivityDelay: number;\n    private lastActiveAt: number;\n    private timer?: number;\n    private userIsInactive: boolean = false;\n    private throttledReset: () => void;\n\n    /**\n     * Private constructor to enforce singleton pattern.\n     * @param target The target to monitor for activity.\n     * @param options Configuration options for the watcher.\n     */\n    private constructor(target: EventTarget, options: InactivityWatcherOptionsInterface) {\n        super(target, options.debug ?? false);\n        this.inactivityDelay = options.inactivityDelay;\n        this.lastActiveAt = Date.now();\n        this.throttledReset = throttle(() => this.resetTimer(), 200);\n\n        this.log(`Initialized with inactivityDelay=${this.inactivityDelay}ms`);\n        this.addEventListeners();\n    }\n\n    /**\n     * Get the singleton instance of the InactivityWatcher.\n     * @param options Configuration options for the watcher.\n     * @returns The singleton instance.\n     */\n    static getInstance(options: InactivityWatcherOptionsInterface): InactivityWatcher {\n        if (!this._instance) {\n            this._instance = new InactivityWatcher(options.target ?? document, options);\n        }\n        return this._instance;\n    }\n\n    /**\n     * Add event listeners to monitor user activity.\n     */\n    protected addEventListeners(): void {\n        this.addDomListener('mousemove', this.throttledReset);\n        this.addDomListener('keydown', this.throttledReset);\n        this.addDomListener('scroll', this.throttledReset);\n        this.addDomListener('visibilitychange', this.throttledReset);\n\n        this.resetTimer();\n    }\n\n    /**\n     * Remove all event listeners and clear the timer.\n     */\n    protected removeEventListeners(): void {\n        this.removeAllDomListeners();\n\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = undefined;\n        }\n    }\n\n    /**\n     * Reset the inactivity timer and emit an active event if the user was inactive.\n     */\n    private resetTimer(): void {\n        const now = Date.now();\n        this.lastActiveAt = now;\n\n        if (this.userIsInactive) {\n            this.userIsInactive = false;\n            eventBus.emit(EVENTS.USER_ACTIVE, {\n                lastActiveAt: this.lastActiveAt,\n                inactivityDelay: this.inactivityDelay,\n                visible: document.visibilityState === 'visible',\n            });\n            this.log('User is active');\n        }\n\n        if (this.timer) clearTimeout(this.timer);\n        this.timer = window.setTimeout(() => this.setInactive(), this.inactivityDelay);\n    }\n\n    /**\n     * Mark the user as inactive and emit an inactive event.\n     */\n    private setInactive(): void {\n        this.userIsInactive = true;\n        const now = Date.now();\n        eventBus.emit(EVENTS.USER_INACTIVE, {\n            lastActiveAt: this.lastActiveAt,\n            inactiveAt: now,\n            inactivityDelay: this.inactivityDelay,\n            visible: document.visibilityState === 'visible',\n        });\n        this.log('User is inactive');\n    }\n}\n", "// src/system/bin/EventLogger.ts\nexport const VERSION = '2.0.0' as const;\n\nimport { eventBus } from '../bin/EventBus.js';\n\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error' | 'event';\n\nexport interface LogEntry {\n  level: LogLevel;\n  scope: string;\n  message: string;\n  data?: any;\n  time: number;\n}\n\nexport class EventLogger {\n  private scope: string;\n  private devMode: boolean;\n  private fallbackLogs: LogEntry[] = []; // Fallback storage for logs\n\n  constructor(scope: string, devMode: boolean = true) {\n    this.scope = scope;\n    this.devMode = devMode;\n  }\n\n  /**\n   * Filters logs based on the configured log level.\n   * Suppresses logs below the specified level in production.\n   */\n  private shouldLog(level: LogLevel): boolean {\n    const levels = ['debug', 'info', 'event', 'warn', 'error'];\n    const currentLevelIndex = levels.indexOf(this.devMode ? 'debug' : 'warn');\n    const logLevelIndex = levels.indexOf(level);\n    return logLevelIndex >= currentLevelIndex;\n  }\n\n  /**\n   * Log a message with the specified level.\n   * @param level The log level (e.g., debug, info, warn, error).\n   * @param message The log message.\n   * @param data Optional additional data to log.\n   */\n  private log(level: LogLevel, message: string, data?: any) {\n    if (!this.shouldLog(level)) return;\n\n    const entry: LogEntry = {\n      level,\n      scope: this.scope,\n      message,\n      data,\n      time: Date.now()\n    };\n\n    try {\n      // Attempt to emit structured log event\n      eventBus.emit('log', entry);\n    } catch (error) {\n      // Fallback to in-memory storage if eventBus fails\n      this.fallbackLogs.push(entry);\n      if (this.devMode) {\n        console.error(`[EventLogger][ERROR] Failed to emit log event`, { entry, error });\n      }\n    }\n\n    // Console output only in devMode (except errors are always useful in dev)\n    if (this.devMode) {\n      console.debug(`[EventLogger][DEBUG] Logging to console`, { level, message, data }); // Debug log for visibility\n      this.consoleOutput(level, message, data);\n    }\n  }\n\n  /**\n   * Output log to the console based on the log level.\n   * @param level The log level.\n   * @param message The log message.\n   * @param data Optional additional data to log.\n   */\n  private consoleOutput(level: LogLevel, message: string, data?: any) {\n    let method: 'log' | 'warn' | 'error';\n    switch (level) {\n      case 'warn': method = 'warn'; break;\n      case 'error': method = 'error'; break;\n      default: method = 'log'; // debug, info, event \u2192 log\n    }\n\n    const prefix = `[${this.scope}][${level.toUpperCase()}]`;\n    if (data !== undefined) {\n      console[method](prefix, message, data);\n    } else {\n      console[method](prefix, message);\n    }\n  }\n\n  /**\n   * Retrieve fallback logs stored in memory.\n   * @returns An array of fallback log entries.\n   */\n  getFallbackLogs(): LogEntry[] {\n    return this.fallbackLogs;\n  }\n\n  debug(msg: string, data?: any) { this.log('debug', msg, data); }\n  info(msg: string, data?: any) { this.log('info', msg, data); }\n  warn(msg: string, data?: any) { this.log('warn', msg, data); }\n  event(msg: string, data?: any) { this.log('event', msg, data); }\n  error(msg: string, data?: any) { this.log('error', msg, data); }\n}\n", "// src/spaceface/system/bin/EventBinder.ts\n\n/**\n * EventBinder v1.2.2\n *\n * Manages the lifecycle of EventBus and DOM event bindings with\n * support for auto-unbinding, debugging, and scoped lifetimes.\n *\n * Provides a single utility class for safely attaching and\n * detaching event handlers in a structured way.\n */\nexport const VERSION = '2.0.0' as const;\n\nimport {\n  DomBinding,\n  EventBinderStats,\n  EventBinderInterface,\n  BusBindingInterface\n} from \"../types/bin.js\";\n\nimport { eventBus } from \"./EventBus.js\";\nimport { EventLogger } from \"./EventLogger.js\";\n\ninterface IEventBinderDebugPayload {\n  method: string;\n  details: unknown;\n}\n\n/**\n * EventBinder\n *\n * A utility for managing event bindings across EventBus and DOM.\n * Keeps track of all active bindings and supports automatic cleanup.\n */\nexport class EventBinder implements EventBinderInterface {\n  private IBusBindings: BusBindingInterface[] = [];\n  private domBindings: DomBinding[] = [];\n  private debugMode: boolean;\n  private logger: EventLogger;\n\n  /**\n   * Create a new EventBinder.\n   * @param debug Enable debug logging (emits `debug:EventBinder` events)\n   */\n  constructor(debug = false) {\n    this.debugMode = debug;\n    this.logger = new EventLogger(\"eventbinder\");\n  }\n\n  /**\n   * Emit debug info via EventBus if debug mode is enabled.\n   * @param method The method name where the debug is called.\n   * @param details Additional details to log.\n   */\n  private debug(method: string, details: unknown): void {\n    if (!this.debugMode) return;\n    try {\n      const payload: IEventBinderDebugPayload = { method, details };\n      this.logger.debug(method, payload);\n    } catch (error) {\n      console.error(`Debugging failed in method: ${method}`, error);\n    }\n  }\n\n  /**\n   * Attach binder lifetime to an AbortSignal.\n   * All bindings will be unbound automatically when the signal aborts.\n   * @param signal AbortSignal to link binder lifetime to.\n   * @returns Unsubscribe function that removes the abort listener.\n   */\n  attachTo(signal: AbortSignal): () => void {\n    if (signal.aborted) {\n      this.unbindAll();\n      return () => {};\n    }\n    const listener = () => this.unbindAll();\n    signal.addEventListener(\"abort\", listener, { once: true });\n    // return an unsubscribe so callers (eg tests) can remove the attachment without aborting the signal\n    return () => {\n      try {\n        signal.removeEventListener(\"abort\", listener);\n      } catch (error) {\n        console.warn(\"Failed to remove abort listener\", error);\n      }\n    };\n  }\n\n  /**\n   * Toggle debug mode at runtime.\n   * @param enable Set to true to enable debug mode, false to disable.\n   */\n  public setDebugMode(enable: boolean): void {\n    this.debugMode = enable;\n    this.logger.info(`Debug mode ${enable ? 'enabled' : 'disabled'}`);\n  }\n\n  /**\n   * Bind a handler to an EventBus event.\n   * @param event Event name\n   * @param handler Event handler function\n   */\n  bindBus(event: string, handler: (...args: any[]) => void): void {\n    if (this.IBusBindings.find(b => b.event === event && b.handler === handler)) {\n      this.debug(\"bus:bind:duplicate\", { event, handler });\n      return;\n    }\n    try {\n      const unsubscribe = eventBus.on(event, handler);\n      this.IBusBindings.push({ event, handler, unsubscribe });\n      this.debug(\"bus:bind\", { event, handler });\n    } catch (err) {\n      this.logger.error(`Failed to bind bus event \"${event}\": ${err instanceof Error ? err.message : String(err)}`);\n    }\n  }\n\n  /**\n   * Bind a DOM event handler with automatic tracking and unbind support.\n   * @param target Target element or EventTarget\n   * @param event Event name\n   * @param handler Event listener\n   * @param options Optional event listener options\n   */\n  bindDOM(\n    target: EventTarget,\n    event: string,\n    handler: EventListenerOrEventListenerObject,\n    options: AddEventListenerOptions | boolean = false\n  ): void {\n    // Duck-typing check so this works in non-browser/test runtimes where EventTarget instanceof may fail\n    if (!target || typeof (target as any).addEventListener !== \"function\" || typeof (target as any).removeEventListener !== \"function\") {\n      this.logger.warn(`Invalid DOM target for bindDOM: ${String(target)}`);\n      return;\n    }\n\n    const controller = new AbortController();\n    const normalizedOptions: AddEventListenerOptions =\n      typeof options === \"boolean\"\n        ? { capture: options, signal: controller.signal }\n        : { ...options, signal: controller.signal };\n\n    // simple options equality (compare capture/passive/once) to avoid duplicate bindings with identical semantics\n    const optionsEqual = (a?: AddEventListenerOptions, b?: AddEventListenerOptions) =>\n      (!!a === !!b) &&\n      ((a?.capture ?? false) === (b?.capture ?? false)) &&\n      ((a?.passive ?? false) === (b?.passive ?? false)) &&\n      ((a?.once ?? false) === (b?.once ?? false));\n\n    if (this.domBindings.find(b => b.target === target && b.event === event && b.handler === handler && optionsEqual(b.options, normalizedOptions))) {\n      this.debug(\"dom:bind:duplicate\", { event, handler, target, options: normalizedOptions });\n      return;\n    }\n\n    try {\n      (target as EventTarget).addEventListener(event, handler, normalizedOptions);\n      this.domBindings.push({ target, event, handler, options: normalizedOptions, controller });\n      this.debug(\"dom:bind\", { event, handler, target, options: normalizedOptions });\n    } catch (err) {\n      this.logger.error(`Failed to bind DOM event \"${event}\": ${err instanceof Error ? err.message : String(err)}`);\n    }\n  }\n\n  /**\n   * Unbind all EventBus and DOM event handlers managed by this binder.\n   */\n  unbindAll(): void {\n    this.debug(\"unbindAll\", {\n      bus: this.IBusBindings.length,\n      dom: this.domBindings.length,\n    });\n\n    for (const b of this.IBusBindings) {\n      try {\n        b.unsubscribe();\n        this.debug(\"bus:unbind\", { event: b.event });\n      } catch (err) {\n        this.logger.error(`Failed to unbind bus \"${b.event}\": ${err instanceof Error ? err.message : String(err)}`);\n      }\n    }\n\n    for (const b of this.domBindings) {\n      try {\n        b.controller.abort();\n        this.debug(\"dom:unbind\", { event: b.event, target: b.target });\n      } catch (err) {\n        this.logger.error(`Failed to unbind DOM \"${b.event}\": ${err instanceof Error ? err.message : String(err)}`);\n      }\n    }\n\n    this.IBusBindings = [];\n    this.domBindings = [];\n  }\n\n  /**\n   * Unbind a specific EventBus handler.\n   * @param event Event name\n   * @param handler Event handler\n   * @returns True if successfully unbound, false otherwise\n   */\n  unbindBus(event: string, handler: (...args: any[]) => void): boolean {\n    const i = this.IBusBindings.findIndex(b => b.event === event && b.handler === handler);\n    if (i === -1) return false;\n\n    try {\n      this.IBusBindings[i].unsubscribe();\n      this.IBusBindings.splice(i, 1);\n      this.debug(\"bus:unbind:single\", { event, handler });\n      return true;\n    } catch (err) {\n      this.logger.error(`Failed to unbind bus \"${event}\": ${err instanceof Error ? err.message : String(err)}`);\n      return false;\n    }\n  }\n\n  /**\n   * Unbind a specific DOM event handler.\n   * @param target Target element\n   * @param event Event name\n   * @param handler Event listener\n   * @returns True if successfully unbound, false otherwise\n   */\n  unbindDOM(target: EventTarget, event: string, handler: EventListenerOrEventListenerObject): boolean {\n    const i = this.domBindings.findIndex(b => b.target === target && b.event === event && b.handler === handler);\n    if (i === -1) return false;\n\n    try {\n      this.domBindings[i].controller.abort();\n      this.domBindings.splice(i, 1);\n      this.debug(\"dom:unbind:single\", { event, target });\n      return true;\n    } catch (err) {\n      this.logger.error(`Failed to unbind DOM \"${event}\": ${err instanceof Error ? err.message : String(err)}`);\n      return false;\n    }\n  }\n\n  /**\n   * Get binding statistics.\n   * @returns Number of bus and DOM events currently bound\n   */\n  getStats(): EventBinderStats {\n    return {\n      busEvents: this.IBusBindings.length,\n      domEvents: this.domBindings.length,\n      totalEvents: this.IBusBindings.length + this.domBindings.length,\n    };\n  }\n\n  /**\n   * Check if there are any active bindings.\n   * @returns True if any EventBus or DOM bindings exist\n   */\n  hasBindings(): boolean {\n    return this.IBusBindings.length > 0 || this.domBindings.length > 0;\n  }\n\n  /**\n   * Get details of all active bindings.\n   * @returns Object with arrays of bus and DOM binding info\n   */\n  getBindingDetails(): { bus: string[]; dom: string[] } {\n    return {\n      bus: this.IBusBindings.map(b => b.event),\n      dom: this.domBindings.map(b => `${b.event}@${b.target.constructor.name}`),\n    };\n  }\n\n  /**\n   * Utility wrapper for scoped binding lifetimes.\n   * Automatically unbinds after callback execution (sync or async).\n   *\n   * @param callback Function that receives a temporary EventBinder\n   * @param debug Enable debug mode\n   * @returns The callback result\n   */\n  static withAutoUnbind<T>(\n    callback: (binder: EventBinder) => T | Promise<T>,\n    debug = false\n  ): Promise<T> | T {\n    const binder = new EventBinder(debug);\n    try {\n      const result = callback(binder);\n      if (result instanceof Promise) {\n        return result.finally(() => binder.unbindAll());\n      } else {\n        binder.unbindAll();\n        return result;\n      }\n    } catch (err) {\n      binder.unbindAll();\n      throw err;\n    }\n  }\n}\n\n/** Default shared EventBinder instance */\nexport const eventBinder = new EventBinder();\n", "// src/spaceface/system/bin/PartialLoader.ts\nexport const VERSION = '2.0.0' as const;\n\nimport { debounce } from \"../features/bin/timing.js\";\nimport { eventBus } from \"./EventBus.js\";\n\nimport {\n    PartialLoaderOptionsInterface,\n    PartialLoadResultInterface,\n    PartialInfoInterface,\n    PartialEventPayload,\n    LogPayload\n} from \"../types/bin.js\";\n\nexport class PartialLoader {\n    private cache = new Map<string, string>();\n    private loadingPromises = new Map<string, Promise<string>>();\n    private loadedPartials = new Map<string, boolean>();\n    private options: Required<PartialLoaderOptionsInterface>;\n\n    constructor(options: PartialLoaderOptionsInterface = {}) {\n        this.options = {\n            debug: false,\n            baseUrl: \"/\",\n            cacheEnabled: true,\n            timeout: 10000,\n            retryAttempts: 3,\n            ...options,\n        };\n    }\n\n    /** Emit debug events instead of console.debug */\n    private logDebug(msg: string, data?: unknown) {\n        if (this.options.debug) {\n            const logKey = `${msg}-${JSON.stringify(data)}`;\n            if (!this.loadedPartials.has(logKey)) {\n                this.loadedPartials.set(logKey, true);\n                const payload: LogPayload = {\n                    scope: \"PartialLoader\",\n                    level: \"debug\",\n                    message: msg,\n                    data,\n                    time: Date.now(),\n                };\n                eventBus.emit(\"log:debug\", payload);\n                eventBus.emit(\"log\", payload);\n            }\n        }\n    }\n\n    /** Load partials from links or info objects */\n    async load(\n        input: HTMLLinkElement | PartialInfoInterface | (HTMLLinkElement | PartialInfoInterface)[]\n    ): Promise<PartialLoadResultInterface[]> {\n        const items = Array.isArray(input) ? input : [input];\n        const results: PartialLoadResultInterface[] = [];\n\n        for (const item of items) {\n            try {\n                if (item instanceof HTMLLinkElement) {\n                    results.push(await this.loadLink(item));\n                } else {\n                    results.push(await this.loadInfo(item));\n                }\n            } catch (error) {\n                const url = item instanceof HTMLLinkElement\n                    ? item.getAttribute(\"src\") || \"\"\n                    : item.url;\n                this.logDebug(\"Failed to load partial\", { url, error });\n                results.push({ success: false, url, cached: false });\n            }\n        }\n\n        eventBus.emit<PartialEventPayload>(\"partials:allLoaded\", { url: \"\", cached: false });\n        this.logDebug(\"All partials loaded\", { count: results.length });\n        return results;\n    }\n\n    private loadLink(link: HTMLLinkElement) {\n        const src = link.getAttribute(\"src\");\n        if (!src) throw new Error(\"Partial link missing src\");\n        return this.loadUrl(this.resolveUrl(src), link);\n    }\n\n    private loadInfo(info: PartialInfoInterface) {\n        return this.loadUrl(this.resolveUrl(info.url), info.container, info.id);\n    }\n\n    private async loadUrl(url: string, container: Element | ParentNode, id?: string): Promise<PartialLoadResultInterface> {\n        try {\n            if (this.options.cacheEnabled && this.cache.has(url)) {\n                this.insertHTML(container, this.cache.get(url)!);\n                this.loadedPartials.set(id || url, true);\n\n                eventBus.emit<PartialEventPayload>(\"partial:loaded\", { url, html: this.cache.get(url)!, cached: true });\n                this.logDebug(\"Partial loaded from cache\", { url, id });\n                return { success: true, url, cached: true };\n            }\n\n            let fetchPromise = this.loadingPromises.get(url);\n            if (!fetchPromise) {\n                fetchPromise = this.fetchWithRetry(url);\n                this.loadingPromises.set(url, fetchPromise);\n            }\n\n            const html = await fetchPromise;\n            if (this.options.cacheEnabled) this.cache.set(url, html);\n\n            this.insertHTML(container, html);\n            this.loadedPartials.set(id || url, true);\n\n            eventBus.emit<PartialEventPayload>(\"partial:loaded\", { url, html, cached: false });\n            this.logDebug(\"Partial loaded\", { url, id });\n            return { success: true, url, cached: false };\n        } catch (error) {\n            this.showError(container, error as Error);\n            eventBus.emit<PartialEventPayload>(\"partial:error\", { url, error });\n            this.logDebug(\"Partial load failed\", { url, id, error });\n            throw error;\n        } finally {\n            this.loadingPromises.delete(url);\n            eventBus.emit<PartialEventPayload>(\"partial:load:complete\", { url });\n            this.logDebug(\"Partial load complete\", { url, id });\n        }\n    }\n\n    private async fetchWithRetry(url: string, attempt = 1): Promise<string> {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.options.timeout);\n\n        try {\n            const res = await fetch(url, { signal: controller.signal, headers: { Accept: \"text/html\" } });\n            if (!res.ok) throw new Error(`HTTP ${res.status}`);\n            const html = (await res.text()).trim();\n            if (!html) throw new Error(\"Empty response\");\n            return html;\n        } catch (err) {\n            if (attempt < this.options.retryAttempts) {\n                this.logDebug(\"Retrying fetch\", { url, attempt });\n                await this.delay(Math.min(2 ** attempt * 100, 5000));\n                return this.fetchWithRetry(url, attempt + 1);\n            }\n            throw err;\n        } finally {\n            clearTimeout(timeoutId);\n        }\n    }\n\n    private async fetchPartial(url: string, attempt = 1): Promise<string> {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.options.timeout);\n\n        try {\n            const res = await fetch(url, { signal: controller.signal, headers: { Accept: \"text/html\" } });\n            if (!res.ok) throw new Error(`HTTP ${res.status}`);\n            const html = (await res.text()).trim();\n            if (!html) throw new Error(\"Empty response\");\n            return html;\n        } catch (err) {\n            if (attempt < this.options.retryAttempts) {\n                this.logDebug(\"Retrying fetch\", { url, attempt });\n                await this.delay(Math.min(2 ** attempt * 100, 5000));\n                return this.fetchPartial(url, attempt + 1);\n            }\n            throw err;\n        } finally {\n            clearTimeout(timeoutId);\n        }\n    }\n\n    private insertHTML(container: ParentNode | Element, html: string) {\n        const template = document.createElement(\"template\");\n        template.innerHTML = html;\n\n        if (container instanceof HTMLLinkElement) {\n            container.replaceWith(...template.content.childNodes);\n        } else if (container instanceof Element) {\n            container.innerHTML = \"\";\n            container.append(...template.content.childNodes);\n        } else {\n            container.append(...template.content.childNodes);\n        }\n\n        this.logDebug(\"Inserted HTML into container\", { container });\n    }\n\n    private showError(container: ParentNode | Element, error: Error) {\n        const div = document.createElement(\"div\");\n        div.className = \"partial-error\";\n        div.textContent = \"Partial load failed\";\n        if (this.options.debug) div.textContent += `: ${error.message}`;\n\n        if (container instanceof HTMLLinkElement) {\n            container.replaceWith(div);\n        } else if (container instanceof Element) {\n            container.innerHTML = \"\";\n            container.appendChild(div);\n        } else {\n            container.appendChild(div);\n        }\n\n        eventBus.emit(\"log:error\", {\n            scope: \"PartialLoader\",\n            message: \"Partial load failed\",\n            error,\n            context: {\n                url: container instanceof HTMLLinkElement ? container.href : undefined,\n                retryAttempts: this.options.retryAttempts,\n            },\n        });\n        this.logDebug(\"Error displayed in container\", { container, error });\n    }\n\n    isPartialLoaded(id: string) {\n        return this.loadedPartials.has(id);\n    }\n\n    private resolveUrl(src: string): string {\n        if (/^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(src) || src.startsWith(\"//\")) {\n            this.logDebug(\"URL is already absolute\", { src });\n            return src;\n        }\n\n        try {\n            const base = this.options.baseUrl || window.location.origin + \"/\";\n            const url = new URL(src, base).toString();\n            const resolvedUrl = url.startsWith(window.location.origin)\n                ? url.slice(window.location.origin.length) || \"/\"\n                : url;\n            this.logDebug(\"Resolved relative URL\", { src, resolvedUrl });\n            return resolvedUrl;\n        } catch (error) {\n            this.logDebug(\"Failed to resolve URL\", { src, error });\n            return src;\n        }\n    }\n\n    private delay(ms: number): Promise<void> {\n        this.logDebug(\"Delaying execution\", { ms });\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    async loadContainer(container: ParentNode = document): Promise<PartialLoadResultInterface[]> {\n        const links = container.querySelectorAll<HTMLLinkElement>('link[rel=\"partial\"][src]');\n        if (!links.length) return [];\n        return this.load(Array.from(links));\n    }\n\n    watch(container: HTMLElement | Document = document.body) {\n        if (!window.MutationObserver) return;\n        const observer = new MutationObserver(\n            debounce(() => this.loadContainer(container), 100)\n        );\n        observer.observe(container, { childList: true, subtree: true });\n        this.logDebug(\"Watching container for partials\", { container });\n        return observer;\n    }\n\n    /** Exposed method so PartialFetcher can reuse loader's cache + retry */\n    async fetchWithLoaderCache(url: string): Promise<string> {\n        if (this.options.cacheEnabled && this.cache.has(url)) {\n            this.logDebug(\"Fetching from cache\", { url });\n            return this.cache.get(url)!;\n        }\n        const html = await this.fetchPartial(url);\n        if (this.options.cacheEnabled) this.cache.set(url, html);\n        this.logDebug(\"Fetched and cached partial\", { url });\n        return html;\n    }\n}\n", "// src/system/bin/PartialFetcher.ts\nexport const VERSION = '2.0.0' as const;\n\nimport { eventBus } from \"./EventBus.js\";\nimport { PartialLoader } from \"./PartialLoader.js\";\nimport type { PartialFetchOptionsInterface, PartialEventPayload, PartialLoaderLike, LogPayload } from \"../types/bin.js\";\n\nexport class PartialFetcher {\n    /** Default internal loader instance */\n    private static loader: PartialLoaderLike;\n\n    /**\n     * Get or create the default loader instance.\n     * @returns The default loader instance.\n     */\n    private static getLoader(): PartialLoaderLike {\n        return this.loader ?? (this.loader = new PartialLoader());\n    }\n\n    /**\n     * Emit debug logs via EventBus.\n     * @param message The debug message.\n     * @param data Additional data to log.\n     */\n    private static logDebug(message: string, data?: unknown): void {\n        const payload: LogPayload = {\n            scope: \"PartialFetcher\",\n            level: \"debug\",\n            message,\n            data,\n            time: Date.now(),\n        };\n        eventBus.emit(\"log\", payload);\n    }\n\n    /**\n     * Load a partial HTML into a target container.\n     * @param url The URL of the partial to load.\n     * @param targetSelector The CSS selector of the target container.\n     * @param options Additional options for the loader.\n     */\n    static async load(\n        url: string,\n        targetSelector: string,\n        options: PartialFetchOptionsInterface = {}\n    ): Promise<void> {\n        const loader = options.loader ?? this.getLoader();\n        const container = document.querySelector<HTMLElement>(targetSelector);\n        if (!container) throw new Error(`Target ${targetSelector} not found`);\n\n        try {\n            this.logDebug(\"Fetching partial\", { url, targetSelector });\n            await loader.load([{ url, container }]);\n            eventBus.emit<PartialEventPayload>(\"partial:loaded\", { url, targetSelector, cached: false });\n            this.logDebug(\"Partial loaded successfully\", { url, targetSelector });\n        } catch (error) {\n            eventBus.emit<PartialEventPayload>(\"partial:error\", { url, error });\n            this.logDebug(\"Partial load error\", { url, error });\n            throw error;\n        } finally {\n            eventBus.emit<PartialEventPayload>(\"partial:load:complete\", { url, targetSelector, error: false });\n        }\n    }\n\n    /**\n     * Preload multiple partials without rendering them.\n     * @param urls The URLs of the partials to preload.\n     * @param loader Optional custom loader instance.\n     * @returns A promise that resolves when all partials are preloaded.\n     */\n    static async preload(urls: string[], loader?: PartialLoaderLike): Promise<void[]> {\n        const activeLoader = loader ?? this.getLoader();\n        const dummyContainer = document.createElement(\"div\");\n\n        return Promise.all(\n            urls.map(async (url) => {\n                try {\n                    this.logDebug(\"Preloading partial\", { url });\n                    await activeLoader.load([{ url, container: dummyContainer }]);\n                    eventBus.emit<PartialEventPayload>(\"partial:loaded\", { url, cached: true });\n                } catch (error) {\n                    eventBus.emit<PartialEventPayload>(\"partial:error\", { url, error });\n                    this.logDebug(\"Preload error\", { url, error });\n                } finally {\n                    eventBus.emit<PartialEventPayload>(\"partial:load:complete\", { url, error: false });\n                }\n            })\n        );\n    }\n\n    /**\n     * Watch a container for dynamic partial loading.\n     * @param container The container to watch.\n     * @param loader Optional custom loader instance.\n     * @returns The result of the loader's watch method.\n     */\n    static watch(container: HTMLElement | Document = document.body, loader?: PartialLoaderLike): unknown {\n        const activeLoader = loader ?? this.getLoader();\n        this.logDebug(\"Watching container for partials\", { container });\n        return activeLoader.watch?.(container);\n    }\n}\n", "// src/spaceface/system/features/bin/AsyncImageLoader.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport {\n  AsyncImageLoaderOptions,\n  SourceDataInterface,\n  ImageMetadataInterface,\n  ImageLoadResultInterface\n} from '../../types/bin.js';\n\nexport class AsyncImageLoader {\n  private container: Element | null;\n  private includePicture: boolean;\n  private debug: boolean;\n  private cache = new WeakMap<HTMLImageElement, boolean>();\n  private destroyed = false;\n\n  constructor(container: Element, options: AsyncImageLoaderOptions = {}) {\n    if (!(container instanceof Element)) {\n      throw new Error(\"AsyncImageLoader: container must be a DOM Element.\");\n    }\n    this.container = container;\n    this.includePicture = options.includePicture ?? false;\n    this.debug = options.debug ?? false;\n  }\n\n  private logDebug(message: string, data?: unknown): void {\n    if (!this.debug) return;\n    console.debug(`[AsyncImageLoader] ${message}`, data);\n  }\n\n  private ensureActive(methodName: string): void {\n    if (this.destroyed || !this.container) {\n      throw new Error(`AsyncImageLoader: Instance destroyed. Method: ${methodName}`);\n    }\n  }\n\n  public getImages(selector = \"img\"): HTMLImageElement[] {\n    this.ensureActive(\"getImages\");\n    if (!selector.trim()) return [];\n\n    const images = new Set<HTMLImageElement>();\n\n    this.container!.querySelectorAll(selector).forEach(el => {\n      if (el instanceof HTMLImageElement) {\n        if (!this.includePicture && el.closest(\"picture\")) return;\n        images.add(el);\n      }\n    });\n\n    return [...images];\n  }\n\n  // ---------- Overloads ----------\n  public async waitForImagesToLoad(\n    selector?: string,\n    includeFailed?: false\n  ): Promise<HTMLImageElement[]>;\n\n  public async waitForImagesToLoad(\n    selector: string,\n    includeFailed: true\n  ): Promise<ImageLoadResultInterface[]>;\n\n  // ---------- Implementation ----------\n  public async waitForImagesToLoad(\n    selector = \"img\",\n    includeFailed = false,\n    timeout = 10000\n  ): Promise<HTMLImageElement[] | ImageLoadResultInterface[]> {\n    this.logDebug(\"Waiting for images to load\", { selector, includeFailed, timeout });\n    const images = this.getImages(selector);\n\n    const results = await Promise.all(\n      images.map(img => {\n        if (this.cache.has(img)) {\n          this.logDebug(\"Image already cached\", { img });\n          return { element: img, loaded: true };\n        }\n\n        if (img.complete && img.naturalWidth > 0) {\n          this.cache.set(img, true);\n          this.logDebug(\"Image already loaded\", { img });\n          return { element: img, loaded: true };\n        }\n\n        return new Promise<ImageLoadResultInterface>(resolve => {\n          const onLoad = () => {\n            clearTimeout(timer);\n            this.cache.set(img, true);\n            this.logDebug(\"Image loaded successfully\", { img });\n            resolve({ element: img, loaded: true });\n          };\n\n          const onError = () => {\n            clearTimeout(timer);\n            this.logDebug(\"Image failed to load\", { img });\n            resolve({ element: img, loaded: false });\n          };\n\n          const timer = setTimeout(() => {\n            img.removeEventListener(\"load\", onLoad);\n            img.removeEventListener(\"error\", onError);\n            this.logDebug(\"Image load timeout\", { img });\n            resolve({ element: img, loaded: false });\n          }, timeout);\n\n          img.addEventListener(\"load\", onLoad, { once: true });\n          img.addEventListener(\"error\", onError, { once: true });\n        });\n      })\n    );\n\n    return includeFailed\n      ? results\n      : results.filter(r => r.loaded).map(r => r.element);\n  }\n\n  public getImageData(selector = \"img\"): ImageMetadataInterface[] {\n    return this.getImages(selector).map(img => {\n      const sources: SourceDataInterface[] = [];\n\n      if (this.includePicture) {\n        const picture = img.closest(\"picture\");\n        if (picture) {\n          picture.querySelectorAll(\"source\").forEach(source => {\n            sources.push({\n              srcset: source.srcset || \"\",\n              type: source.type || \"\",\n              media: source.media || \"\"\n            });\n          });\n        }\n      }\n\n      return {\n        element: img,\n        src: img.src || \"\",\n        alt: img.alt || \"\",\n        href: img.closest(\"a\")?.href ?? null,\n        sources\n      };\n    });\n  }\n\n  public clearCache(): void {\n    this.logDebug(\"Clearing image cache\");\n    this.cache = new WeakMap();\n  }\n\n  public destroy(): void {\n    this.container = null;\n    this.destroyed = true;\n  }\n}\n", "// src/spaceface/system/features/bin/AnimationLoop.ts\n\nexport const VERSION = '2.0.0' as const;\n\ntype FrameCallback = () => void;\n\n/**\n * Manages a loop of animation frames, allowing callbacks to be added and removed dynamically.\n * Ensures safe execution of callbacks and handles errors gracefully.\n */\nexport class AnimationLoop {\n    private callbacks: Set<FrameCallback> = new Set();\n    private running = false;\n    private _rafId: number | null = null;\n    private errorHandler: (error: unknown) => void;\n\n    constructor(errorHandler: (error: unknown) => void = console.error) {\n        this.errorHandler = errorHandler;\n    }\n\n    /**\n     * Adds a callback to the animation loop.\n     * Starts the loop if it is not already running.\n     *\n     * @param callback - The function to be called on each animation frame.\n     */\n    add(callback: FrameCallback): void {\n        if (typeof callback !== 'function') {\n            throw new TypeError('AnimationLoop.add: Callback must be a function');\n        }\n        if (!this.callbacks.has(callback)) this.callbacks.add(callback);\n        this.start();\n    }\n\n    /**\n     * Removes a callback from the animation loop.\n     * Stops the loop if no callbacks remain.\n     *\n     * @param callback - The function to be removed.\n     */\n    remove(callback: FrameCallback): void {\n        this.callbacks.delete(callback);\n        if (this.callbacks.size === 0) this.stop();\n    }\n\n    /**\n     * Removes all callbacks from the animation loop.\n     * Stops the loop if it is running.\n     */\n    clear(): void {\n        this.callbacks.clear();\n        this.stop();\n    }\n\n    /**\n     * Checks if a callback is currently in the animation loop.\n     *\n     * @param callback - The function to check.\n     * @returns True if the callback is in the loop, false otherwise.\n     */\n    has(callback: FrameCallback): boolean {\n        return this.callbacks.has(callback);\n    }\n\n    /**\n     * Pauses the animation loop, stopping all callbacks temporarily.\n     * This is equivalent to calling `stop` but does not clear callbacks.\n     */\n    pause(): void {\n        this.stop();\n    }\n\n    /**\n     * Resumes the animation loop if there are callbacks to execute.\n     */\n    resume(): void {\n        if (this.callbacks.size > 0) this.start();\n    }\n\n    /**\n     * Starts the animation loop if it is not already running.\n     * Private method to ensure controlled access.\n     */\n    private start(): void {\n        if (this.running || this.callbacks.size === 0) return;\n        this.running = true;\n        // Schedule the first frame rather than invoking immediately\n        this._rafId = requestAnimationFrame(this._loop);\n    }\n\n    /**\n     * Stops the animation loop and cancels the next frame.\n     * Private method to ensure controlled access.\n     */\n    private stop(): void {\n        this.running = false;\n        if (this._rafId !== null) cancelAnimationFrame(this._rafId);\n        this._rafId = null;\n    }\n\n    /**\n     * The main loop function, executed on each animation frame.\n     * Iterates over a snapshot of callbacks to allow safe modification during execution.\n     */\n    private _loop = (): void => {\n        if (!this.running) return;\n        for (const cb of Array.from(this.callbacks)) {\n            try {\n                cb();\n            } catch (err) {\n                this.errorHandler(err);\n            }\n        }\n        this._rafId = requestAnimationFrame(this._loop);\n    };\n}\n\n/**\n * A shared instance of the AnimationLoop class for global use.\n */\nexport const animationLoop = new AnimationLoop();\n", "export type AnimationPauseReason = 'manual' | 'hover' | 'hidden' | 'inactivity' | 'screensaver';\n\nexport class AnimationPolicy {\n  private pausedReasons = new Set<AnimationPauseReason>();\n\n  set(reason: AnimationPauseReason, paused: boolean): void {\n    if (paused) this.pausedReasons.add(reason);\n    else this.pausedReasons.delete(reason);\n  }\n\n  has(reason: AnimationPauseReason): boolean {\n    return this.pausedReasons.has(reason);\n  }\n\n  isPaused(): boolean {\n    return this.pausedReasons.size > 0;\n  }\n\n  list(): AnimationPauseReason[] {\n    return Array.from(this.pausedReasons);\n  }\n\n  clear(): void {\n    this.pausedReasons.clear();\n  }\n}\n", "// src/spaceface/features/SlidePlayer/SlidePlayer.ts\n\nexport const VERSION = '2.0.0';\n\nimport { eventBus } from '../../bin/EventBus.js';\nimport { EventBinder } from '../../bin/EventBinder.js';\nimport { AsyncImageLoader } from '../bin/AsyncImageLoader.js';\nimport { animationLoop } from '../bin/AnimationLoop.js';\nimport { AnimationPolicy, AnimationPauseReason } from '../bin/AnimationPolicy.js';\nimport type { LogPayload } from '../../types/bin.js';\nimport { EVENTS } from '../../types/events.js';\n\ninterface ISlidePlayerOptions {\n  interval?: number;\n  includePicture?: boolean;\n  dotsSelector?: string;\n  autoCreateDots?: boolean;\n  startPaused?: boolean;\n  enableBusEvents?: boolean;\n  autoplay?: boolean;\n  debug?: boolean;\n}\n\nexport class SlidePlayer {\n  static readonly SWIPE_THRESHOLD = 50;\n  static readonly VERTICAL_TOLERANCE = 30;\n  static readonly DEFAULT_INTERVAL = 5000;\n\n  private container: HTMLElement;\n  private interval: number;\n  private includePicture: boolean;\n  private dotsSelector: string;\n  private autoCreateDots: boolean;\n  private enableBusEvents: boolean;\n  private autoplay: boolean;\n  private debug: boolean;\n\n  private slides: HTMLElement[] = [];\n  private dots: HTMLDivElement[] = [];\n  private dotsWrapper: HTMLElement | null = null;\n  private currentIndex = 0;\n\n  private lastTickTime = 0;\n  private isDestroyed = false;\n\n  private isPointerDown = false;\n  private pointerStartX = 0;\n  private pointerStartY = 0;\n  private pointerEndX = 0;\n  private pointerEndY = 0;\n\n  private animationPolicy = new AnimationPolicy();\n  private loader: AsyncImageLoader;\n  private binder: EventBinder;\n  private animateCallback: () => void;\n\n  private lastPauseState: boolean = false;\n  public readonly ready: Promise<void>;\n  public initError: unknown = null;\n\n  constructor(\n    containerOrSelector: string | HTMLElement,\n    {\n      interval = SlidePlayer.DEFAULT_INTERVAL,\n      includePicture = false,\n      dotsSelector = '.dots',\n      autoCreateDots = false,\n      startPaused = false,\n      enableBusEvents = true,\n      autoplay = true,\n      debug = false\n    }: ISlidePlayerOptions = {}\n  ) {\n    this.container = this.resolveContainer(containerOrSelector);\n    this.interval = interval > 0 ? interval : SlidePlayer.DEFAULT_INTERVAL;\n    this.includePicture = includePicture;\n    this.dotsSelector = dotsSelector;\n    this.autoCreateDots = autoCreateDots;\n    this.enableBusEvents = enableBusEvents;\n    this.autoplay = autoplay;\n    this.debug = debug;\n\n    this.loader = new AsyncImageLoader(this.container, { includePicture });\n    this.binder = new EventBinder(this.debug);\n\n    if (startPaused) this.animationPolicy.set('manual', true);\n\n    this.animateCallback = () => this.animate();\n    // Ensure init always resolves to avoid unhandled rejection.\n    // If init fails we capture the error in initError for callers to inspect.\n    this.ready = this.init()\n      .catch((err) => {\n        this.initError = err;\n        this.log('error', 'SlidePlayer init failed', err);\n      })\n      .then(() => {});\n\n    this.log('info', 'SlidePlayer initialized', { container: this.container, interval, autoplay, debug });\n  }\n\n  /** ---- Centralized logging ---- */\n  private log(level: 'debug' | 'info' | 'warn' | 'error', message: string, data?: unknown) {\n    if (!this.debug && level === 'debug') return;\n\n    const payload: LogPayload = { scope: 'SlidePlayer', level, message, data, time: Date.now() };\n    eventBus.emit(EVENTS.SLIDEPLAYER_LOG, { level, message, data });\n    eventBus.emit(EVENTS.LOG, payload);\n    if (this.debug) {\n      const methodMap: Record<typeof level, keyof Console> = {\n        debug: 'debug',\n        info: 'info',\n        warn: 'warn',\n        error: 'error'\n      };\n      (console as any)[methodMap[level]]?.(`[SlidePlayer] [${level.toUpperCase()}]`, message, data);\n    }\n  }\n\n  private resolveContainer(containerOrSelector: string | HTMLElement): HTMLElement {\n    const container = typeof containerOrSelector === 'string'\n      ? document.querySelector<HTMLElement>(containerOrSelector)\n      : containerOrSelector;\n    if (!container) throw new Error('SlidePlayer: container element not found.');\n    return container;\n  }\n\n  /** ---- Initialization ---- */\n  private async init(): Promise<void> {\n    await this.loader.waitForImagesToLoad();\n\n    this.refreshSlides();\n    if (!this.slides.length) {\n      this.log('warn', 'No .slide elements found in container.');\n      return;\n    }\n\n    this.setupDots();\n    this.bindEvents();\n    this.setActiveSlide(0);\n    this.lastTickTime = performance.now();\n\n    // bus bindings handled by bindActivityEvents() to avoid duplication\n\n    if (!this.isPaused() && this.autoplay) {\n      animationLoop.add(this.animateCallback);\n    }\n  }\n\n  /** ---- RAF Animation ---- */\n  private animate(): void {\n    if (this.isDestroyed || !this.autoplay || this.isPaused() || this.slides.length < 2) return;\n\n    const now = performance.now();\n    const elapsed = now - this.lastTickTime;\n\n    if (elapsed >= this.interval) {\n      this.next(false);\n      this.lastTickTime = now;\n    }\n  }\n\n  /** ---- Pause / Resume ---- */\n  private togglePause(reason: AnimationPauseReason, shouldPause: boolean): void {\n    this.animationPolicy.set(reason, shouldPause);\n\n    this.emitPauseResumeIfChanged();\n\n    if (this.isPaused()) {\n      if (animationLoop.has(this.animateCallback)) animationLoop.remove(this.animateCallback);\n      this.log('debug', `Paused due to: ${this.animationPolicy.list().join(', ')}`);\n    } else {\n      if (!animationLoop.has(this.animateCallback)) animationLoop.add(this.animateCallback);\n      this.log('debug', 'Resumed playback');\n    }\n  }\n\n  private emitPauseResumeIfChanged(): void {\n      const nowPaused = this.isPaused();\n    if (nowPaused !== this.lastPauseState) {\n      this.lastPauseState = nowPaused;\n      const event = nowPaused ? 'slideplayer:paused' : 'slideplayer:resumed';\n      this.emit(event, { reasons: this.animationPolicy.list() });\n    }\n  }\n\n  public play(): void { this.togglePause('manual', false); }\n  public pause(): void { this.togglePause('manual', true); }\n  public isPaused(): boolean { return this.animationPolicy.isPaused(); }\n\n  /** ---- Slide Navigation ---- */\n  public goToSlide(index: number, restart: boolean = true): void {\n    if (index < 0 || index >= this.slides.length || index === this.currentIndex) return;\n    this.setActiveSlide(index);\n    if (restart) this.resetTimer();\n  }\n\n  public next(restart: boolean = true): void {\n    if (this.slides.length < 2) return;\n    this.goToSlide((this.currentIndex + 1) % this.slides.length, restart);\n  }\n\n  public prev(restart: boolean = true): void {\n    if (this.slides.length < 2) return;\n    const prevIndex = (this.currentIndex - 1 + this.slides.length) % this.slides.length;\n    this.goToSlide(prevIndex, restart);\n  }\n\n  /** ---- Slides / Dots ---- */\n  private refreshSlides(): void {\n    this.slides = Array.from(this.container.querySelectorAll<HTMLElement>('.slide'));\n  }\n\n  private setupDots(): void {\n    this.dotsWrapper = this.container.querySelector(this.dotsSelector);\n    if (!this.dotsWrapper && this.autoCreateDots) {\n      this.dotsWrapper = document.createElement('div');\n      this.dotsWrapper.className = 'dots';\n      this.container.appendChild(this.dotsWrapper);\n    }\n    if (!this.dotsWrapper) return;\n\n    this.dotsWrapper.innerHTML = '';\n    this.dots = this.slides.map((_, i) => {\n      const dot = document.createElement('div');\n      dot.className = 'dot';\n      dot.dataset.index = i.toString();\n      this.binder.bindDOM(dot, 'click', () => this.goToSlide(i));\n      this.dotsWrapper!.appendChild(dot);\n      return dot;\n    });\n  }\n\n  private updateDots(index: number): void {\n    this.dots.forEach((dot, i) => dot.classList.toggle('active', i === index));\n  }\n\n  private setActiveSlide(index: number): void {\n    const prev = this.currentIndex;\n    this.slides[this.currentIndex]?.classList.remove('active');\n    this.currentIndex = index;\n    this.slides[this.currentIndex]?.classList.add('active');\n    this.updateDots(index);\n\n    if (prev !== index) this.emit('slideplayer:slideChanged', { index }, 'slideplayer:slide-changed');\n  }\n\n  private resetTimer(): void { this.lastTickTime = performance.now(); }\n\n  /** ---- Event Binding ---- */\n  private bindEvents(): void {\n    this.bindPointerEvents();\n    this.bindKeyboardEvents();\n    this.bindVisibilityEvents();\n    this.bindActivityEvents();\n    this.bindUnloadEvent();\n  }\n\n  private bindPointerEvents(): void {\n    this.binder.bindDOM(this.container, 'pointerdown', (e) => {\n      const ev = e as PointerEvent;\n      this.isPointerDown = true;\n      this.pointerStartX = ev.clientX; this.pointerStartY = ev.clientY;\n      this.pointerEndX = ev.clientX; this.pointerEndY = ev.clientY;\n    });\n    this.binder.bindDOM(this.container, 'pointermove', (e) => {\n      if (!this.isPointerDown) return;\n      const ev = e as PointerEvent;\n      this.pointerEndX = ev.clientX; this.pointerEndY = ev.clientY;\n    });\n    // listen for pointerup/pointercancel on window so release outside container is handled\n    this.binder.bindDOM(window, 'pointerup', () => {\n      if (this.isPointerDown) { this.handleSwipe(); this.isPointerDown = false; }\n    });\n    this.binder.bindDOM(window, 'pointercancel', () => {\n      this.isPointerDown = false;\n    });\n    this.binder.bindDOM(this.container, 'pointerleave', () => this.isPointerDown = false);\n    this.binder.bindDOM(this.container, 'mouseenter', () => this.togglePause('hover', true));\n    this.binder.bindDOM(this.container, 'mouseleave', () => this.togglePause('hover', false));\n  }\n\n  private bindKeyboardEvents(): void {\n    this.binder.bindDOM(document, 'keydown', (e) => {\n      const ev = e as KeyboardEvent;\n      if (ev.key === 'ArrowRight') this.next();\n      else if (ev.key === 'ArrowLeft') this.prev();\n    });\n  }\n\n  private bindVisibilityEvents(): void {\n    this.binder.bindDOM(document, 'visibilitychange', () => {\n      this.togglePause('hidden', document.visibilityState === 'hidden');\n    });\n  }\n\n  private bindActivityEvents(): void {\n    if (this.enableBusEvents) {\n      this.binder.bindBus(EVENTS.USER_INACTIVE, () => this.togglePause('inactivity', true));\n      this.binder.bindBus(EVENTS.USER_ACTIVE, () => this.togglePause('inactivity', false));\n      this.binder.bindBus(EVENTS.SCREENSAVER_SHOWN, () => this.togglePause('screensaver', true));\n      this.binder.bindBus(EVENTS.SCREENSAVER_HIDDEN, () => this.togglePause('screensaver', false));\n    }\n  }\n\n  private bindUnloadEvent(): void {\n    this.binder.bindDOM(window, 'beforeunload', () => this.destroy());\n  }\n\n  private handleSwipe(): void {\n    const dx = this.pointerEndX - this.pointerStartX;\n    const dy = this.pointerEndY - this.pointerStartY;\n    if (Math.abs(dx) >= SlidePlayer.SWIPE_THRESHOLD && Math.abs(dy) < SlidePlayer.VERTICAL_TOLERANCE) {\n      const direction = dx < 0 ? 'next' : 'prev';\n      this.log('debug', `Swipe detected`, { dx, dy, direction });\n      dx < 0 ? this.next() : this.prev();\n    }\n  }\n\n  private emit(type: string, detail: any, busEvent?: string): void {\n    this.container.dispatchEvent(new CustomEvent(type, { detail, bubbles: true }));\n    if (this.enableBusEvents && busEvent) eventBus.emit(busEvent, detail);\n  }\n\n  public destroy(): void {\n    if (this.isDestroyed) return;\n    this.isDestroyed = true;\n\n    animationLoop.remove(this.animateCallback);\n    this.binder.unbindAll();\n    this.loader.destroy();\n\n    this.slides = [];\n    this.dots = [];\n    this.dotsWrapper = null;\n    this.animationPolicy.clear();\n\n    this.log('info', 'SlidePlayer destroyed');\n  }\n\n  /** ---- Public getters ---- */\n  public get currentSlideIndex(): number { return this.currentIndex; }\n  public get slideCount(): number { return this.slides.length; }\n}\n", "// src/spaceface/system/features/bin/math.ts\n\nexport const VERSION = '2.0.0' as const;\n\n/**\n * Clamps a number within the inclusive range specified by the minimum and maximum values.\n *\n * @param value - The number to clamp.\n * @param min - The lower bound of the range.\n * @param max - The upper bound of the range.\n * @returns The clamped value.\n * @throws Will throw an error if `min` is greater than `max`.\n */\nexport const clamp = (value: number, min: number, max: number): number => {\n  if (min > max) {\n    throw new RangeError('The `min` value cannot be greater than the `max` value.');\n  }\n  return Math.max(min, Math.min(value, max));\n};\n\n/**\n * Performs a linear interpolation between two values.\n *\n * @param a - The start value.\n * @param b - The end value.\n * @param t - The interpolation factor (typically between 0 and 1).\n * @returns The interpolated value.\n * @throws Will throw an error if `t` is not between 0 and 1.\n */\nexport const lerp = (a: number, b: number, t: number): number => {\n  if (t < 0 || t > 1) {\n    throw new RangeError('The interpolation factor `t` must be between 0 and 1.');\n  }\n  return (1 - t) * a + t * b;\n};\n", "// src/spaceface/features/FloatingImages/FloatingImage.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport { clamp } from '../bin/math.js';\n\nimport type {\n    ContainerDimensionsInterface,\n    FloatingImageOptionsInterface\n} from './types.js';\n\nconst DAMPING = 0.85;\nconst MIN_VELOCITY = 0.1;\nconst MAX_SPEED = 2.5;\nconst VELOCITY_JITTER = 0.02;\n\nexport class FloatingImage {\n    private element: HTMLElement | null;\n    private size: { width: number; height: number };\n    private x: number;\n    private y: number;\n    private vx: number;\n    private vy: number;\n    private options: Required<FloatingImageOptionsInterface>;\n\n    constructor(element: HTMLElement, dims: ContainerDimensionsInterface, options: FloatingImageOptionsInterface = {}) {\n        this.element = element;\n        this.options = { useSubpixel: true, debug: false, ...options };\n        this.size = { width: element.offsetWidth, height: element.offsetHeight };\n\n        // guard against negative ranges if container is smaller than image\n        this.x = Math.random() * Math.max(0, dims.width - this.size.width);\n        this.y = Math.random() * Math.max(0, dims.height - this.size.height);\n\n        this.vx = (Math.random() - 0.5) * 3;\n        this.vy = (Math.random() - 0.5) * 3;\n\n        element.style.willChange = 'transform';\n        element.style.backfaceVisibility = 'hidden';\n        element.style.perspective = '1000px';\n        element.style.opacity = '1';\n\n        this.updatePosition();\n    }\n\n    private logDebug(message: string, data?: unknown): void {\n        if (this.options.debug) {\n            console.debug(`[FloatingImage] ${message}`, data);\n        }\n    }\n\n    updatePosition(): boolean {\n        if (!this.element) {\n            this.logDebug(\"updatePosition called on destroyed element\");\n            return false;\n        }\n        const x = this.options.useSubpixel ? this.x : Math.round(this.x);\n        const y = this.options.useSubpixel ? this.y : Math.round(this.y);\n        this.element.style.transform = `translate3d(${x}px, ${y}px, 0)`;\n        this.logDebug(\"Position updated\", { x, y });\n        return true;\n    }\n\n    getElement(): HTMLElement | null {\n        return this.element;\n    }\n\n    update(multiplier: number, dims: ContainerDimensionsInterface, applyPosition = true): boolean {\n        if (!this.element) {\n            this.logDebug(\"update called on destroyed element\");\n            return false;\n        }\n\n        this.x += this.vx * multiplier;\n        this.y += this.vy * multiplier;\n\n        this.handleCollisions(dims);\n        this.applyVelocityJitter();\n\n        if (applyPosition) return this.updatePosition();\n        return true;\n    }\n\n    private handleCollisions(dims: ContainerDimensionsInterface): void {\n        if (this.x <= 0 || this.x + this.size.width >= dims.width) {\n            this.vx = -this.vx * DAMPING;\n            const signX = this.vx >= 0 ? 1 : -1;\n            this.vx = Math.abs(this.vx) < MIN_VELOCITY ? signX * MIN_VELOCITY : this.vx;\n            this.x = clamp(this.x, 0, Math.max(0, dims.width - this.size.width));\n            this.logDebug(\"Horizontal collision handled\", { x: this.x, vx: this.vx });\n        }\n\n        if (this.y <= 0 || this.y + this.size.height >= dims.height) {\n            this.vy = -this.vy * DAMPING;\n            const signY = this.vy >= 0 ? 1 : -1;\n            this.vy = Math.abs(this.vy) < MIN_VELOCITY ? signY * MIN_VELOCITY : this.vy;\n            this.y = clamp(this.y, 0, Math.max(0, dims.height - this.size.height));\n            this.logDebug(\"Vertical collision handled\", { y: this.y, vy: this.vy });\n        }\n    }\n\n    private applyVelocityJitter(): void {\n        this.vx += (Math.random() - 0.5) * VELOCITY_JITTER;\n        this.vy += (Math.random() - 0.5) * VELOCITY_JITTER;\n\n        const speedSquared = this.vx ** 2 + this.vy ** 2;\n        if (speedSquared > MAX_SPEED ** 2) {\n            const scale = MAX_SPEED / Math.sqrt(speedSquared);\n            this.vx *= scale;\n            this.vy *= scale;\n            this.logDebug(\"Velocity clamped\", { vx: this.vx, vy: this.vy });\n        }\n    }\n\n    resetPosition(dims: ContainerDimensionsInterface) {\n        this.x = Math.random() * Math.max(0, dims.width - this.size.width);\n        this.y = Math.random() * Math.max(0, dims.height - this.size.height);\n        this.updatePosition(); // must be called\n    }\n\n\n    updateSize() {\n        if (!this.element) return;\n        this.size.width = this.element.offsetWidth;\n        this.size.height = this.element.offsetHeight;\n    }\n\n    clampPosition(dims: ContainerDimensionsInterface) {\n        this.x = clamp(this.x, 0, Math.max(0, dims.width - this.size.width));\n        this.y = clamp(this.y, 0, Math.max(0, dims.height - this.size.height));\n    }\n\n    destroy() {\n        if (!this.element) return;\n        this.element.style.willChange = 'auto';\n        this.element.style.backfaceVisibility = '';\n        this.element.style.perspective = '';\n        this.element = null;\n    }\n}\n", "// src/spaceface/system/features/bin/PerformanceMonitor.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport {\n  PerformanceLevel,\n  PerformanceSettingsInterface,\n} from '../../types/bin.js';\n\nexport class PerformanceMonitor {\n  private fps: number = 60;\n  private lastTime: number = performance.now();\n  private frameSkipThreshold: number = 30;\n  private shouldSkipFrame: boolean = false;\n  private frameCount: number = 0;\n\n  private cachedPerformanceLevel: PerformanceLevel = 'high';\n  private lastLevelUpdate: number = 0;\n  private levelUpdateInterval: number = 1000;\n  private cachedSettings: PerformanceSettingsInterface | null = null;\n\n  private lastLoggedFPS: number = 60;\n  private fpsLogThreshold: number = 5;\n\n  /** Updates FPS and returns whether to skip this frame */\n  public update(): boolean {\n    const now = performance.now();\n    const delta = now - this.lastTime;\n    if (delta < 1) return this.shouldSkipFrame;\n\n    const currentFPS = 1000 / delta;\n    this.fps = this.fps * 0.9 + currentFPS * 0.1; // smoothing\n    this.frameCount++;\n\n    this.shouldSkipFrame = this.fps < this.frameSkipThreshold;\n\n    if (Math.abs(this.fps - this.lastLoggedFPS) >= this.fpsLogThreshold) {\n      // eventBus.emit('performance:fps', { fps: this.getCurrentFPS(), frameSkip: this.shouldSkipFrame });\n      this.lastLoggedFPS = this.fps;\n    }\n\n    this.lastTime = now;\n    return this.shouldSkipFrame;\n  }\n\n  public getFrameCount(): number { return this.frameCount; }\n  public getCurrentFPS(): number { return Math.round(this.fps * 10) / 10; }\n\n  public getPerformanceLevel(): PerformanceLevel {\n    const now = performance.now();\n    if (now - this.lastLevelUpdate > this.levelUpdateInterval) {\n      this.cachedPerformanceLevel = this.fps >= 50 ? 'high' : this.fps >= 30 ? 'medium' : 'low';\n      this.lastLevelUpdate = now;\n      this.cachedSettings = null;\n      // eventBus.emit('performance:level', { level: this.cachedPerformanceLevel, fps: this.getCurrentFPS() });\n    }\n    return this.cachedPerformanceLevel;\n  }\n\n  public getRecommendedSettings(): PerformanceSettingsInterface {\n    if (this.cachedSettings) return this.cachedSettings;\n\n    const level = this.getPerformanceLevel();\n    const settingsMap: Record<PerformanceLevel, PerformanceSettingsInterface> = {\n      high: { maxImages: 50, speedMultiplier: 1.0, useSubpixel: true },\n      medium: { maxImages: 25, speedMultiplier: 0.8, useSubpixel: false },\n      low: { maxImages: 10, speedMultiplier: 0.5, useSubpixel: false },\n    };\n    this.cachedSettings = settingsMap[level];\n    return this.cachedSettings;\n  }\n\n  public reset(): void {\n    this.fps = 60;\n    this.lastTime = performance.now();\n    this.shouldSkipFrame = false;\n    this.frameCount = 0;\n    this.cachedPerformanceLevel = 'high';\n    this.lastLevelUpdate = 0;\n    this.cachedSettings = null;\n    this.lastLoggedFPS = 60;\n  }\n}\n", "// src/spaceface/system/features/bin/ResizeManager.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport { debounce, throttle, CancellableFunction } from './timing.js';\n\ntype WindowResizeCallback = () => void;\ntype ElementResizeCallback = (entry: ResizeObserverEntry) => void;\n\ninterface ElementObserverEntryInterface {\n  observer: ResizeObserver;\n  callbacks: Set<CancellableFunction<ElementResizeCallback>>;\n}\n\ntype ElementSize = { width: number; height: number };\n\nexport class ResizeManager {\n  private windowCallbacks: Map<WindowResizeCallback, EventListener> = new Map();\n  private elementObservers: Map<Element, ElementObserverEntryInterface> = new Map();\n  private debug = false;\n\n  setDebugMode(enabled: boolean): void {\n    this.debug = enabled;\n  }\n\n  private logDebug(message: string, data?: unknown): void {\n    if (!this.debug) return;\n    console.debug(`[ResizeManager] ${message}`, data);\n  }\n\n  private wrapCallback<T extends (...args: any[]) => void>(\n    cb: T,\n    options?: { debounceMs?: number; throttleMs?: number }\n  ): CancellableFunction<T> {\n    if (options?.debounceMs != null) {\n      return debounce(cb as (...args: any[]) => void, options.debounceMs) as CancellableFunction<T>;\n    } else if (options?.throttleMs != null) {\n      return throttle(cb as (...args: any[]) => void, options.throttleMs) as CancellableFunction<T>;\n    } else {\n      const wrappedCb = cb as CancellableFunction<T>;\n      wrappedCb.cancel = () => {};\n      return wrappedCb;\n    }\n  }\n\n  /**\n   * Register a callback for window resize events.\n   * Optionally debounce or throttle the callback.\n   */\n  onWindow(\n    cb: WindowResizeCallback,\n    options: { debounceMs: number } = { debounceMs: 200 }\n  ): () => void {\n    const wrappedCb = debounce(cb, options.debounceMs);\n    const handler = () => wrappedCb();\n\n    this.windowCallbacks.set(cb, handler);\n    window.addEventListener(\"resize\", handler);\n\n    return (): void => {\n      window.removeEventListener(\"resize\", handler);\n      wrappedCb.cancel?.();\n      this.windowCallbacks.delete(cb);\n    };\n  }\n\n  /**\n   * Register a callback for an element's resize events.\n   * Optionally debounce or throttle the callback.\n   */\n  onElement(\n    el: Element,\n    cb: ElementResizeCallback,\n    options?: { debounceMs?: number; throttleMs?: number }\n  ): () => void {\n    this.logDebug(\"Registering element resize callback\", { el, cb, options });\n    let entry = this.elementObservers.get(el);\n\n    if (!entry) {\n      const callbacks = new Set<CancellableFunction<ElementResizeCallback>>();\n      const observer = new ResizeObserver((entries) => {\n        try {\n          const entry = entries[0];\n          callbacks.forEach(fn => fn(entry));\n        } catch (error) {\n          this.logDebug(\"ResizeObserver callback error\", { error });\n        }\n      });\n\n      entry = { observer, callbacks };\n      this.elementObservers.set(el, entry);\n      observer.observe(el);\n    }\n\n    const wrappedCb = this.wrapCallback(cb, options);\n    entry.callbacks.add(wrappedCb);\n\n    return (): void => {\n      this.logDebug(\"Removing element resize callback\", { el, cb });\n      entry!.callbacks.delete(wrappedCb);\n      wrappedCb.cancel?.();\n      if (entry!.callbacks.size === 0) {\n        entry!.observer.disconnect();\n        this.elementObservers.delete(el);\n      }\n    };\n  }\n\n  /**\n   * Get current size of an element.\n   */\n  getElement(el: Element): ElementSize {\n    try {\n      const rect = el.getBoundingClientRect();\n      // this.logDebug(\"Getting element size\", { el, rect });\n      return { width: rect.width, height: rect.height };\n    } catch (error) {\n      // this.logDebug(\"Error getting element size\", { el, error });\n      throw new Error(\"ResizeManager: Failed to get element size.\");\n    }\n  }\n\n  /**\n   * Cleanup all registered window and element callbacks.\n   */\n  destroy(): void {\n    this.logDebug(\"Destroying ResizeManager\");\n    for (const [cb, handler] of this.windowCallbacks.entries()) {\n      window.removeEventListener(\"resize\", handler);\n    }\n    this.windowCallbacks.clear();\n\n    for (const entry of this.elementObservers.values()) {\n      entry.observer.disconnect();\n      for (const fn of entry.callbacks) {\n        fn.cancel?.();\n      }\n    }\n    this.elementObservers.clear();\n    this.logDebug(\"ResizeManager destroyed\");\n  }\n}\n\n// Singleton instance\nexport const resizeManager = new ResizeManager();\n", "// src/spaceface/features/FloatingImages/FloatingImagesManager.ts\n\nexport const VERSION = '2.1.0' as const;\n\nimport { FloatingImage } from './FloatingImage.js';\nimport { PerformanceMonitor } from '../bin/PerformanceMonitor.js';\nimport { resizeManager } from '../bin/ResizeManager.js';\nimport { AsyncImageLoader } from '../bin/AsyncImageLoader.js';\nimport { animationLoop } from '../bin/AnimationLoop.js';\nimport { eventBus } from '../../bin/EventBus.js';\nimport { debounce } from '../bin/timing.js';\nimport { AnimationPolicy } from '../bin/AnimationPolicy.js';\nimport type { LogPayload } from '../../types/bin.js';\nimport { EVENTS } from '../../types/events.js';\n\nimport type {\n    FloatingImagesManagerOptionsInterface,\n    ContainerDimensionsInterface\n} from './types.js';\nimport type { FloatingImagesManagerInterface } from '../../types/features.js';\n\nexport class FloatingImagesManager implements FloatingImagesManagerInterface {\n    readonly container: HTMLElement;\n    performanceMonitor: PerformanceMonitor;\n    images: FloatingImage[] = [];\n    speedMultiplier: number = 1;\n    isInViewport: boolean = true;\n    private _destroyed: boolean = false;\n    private animateCallback: () => void;\n    maxImages: number;\n    intersectionObserver: IntersectionObserver;\n    unsubscribeWindow?: () => void;\n    unsubscribeElement?: () => void;\n    imageLoader: AsyncImageLoader;\n    containerWidth!: number;\n    containerHeight!: number;\n    debug: boolean;\n    hoverBehavior: 'none' | 'slow' | 'stop';\n    hoverSlowMultiplier: number;\n    tapToFreeze: boolean;\n    pauseOnScreensaver: boolean;\n    private interactionCleanups: Array<() => void> = [];\n    private frozenElements = new WeakSet<HTMLElement>();\n    private imageSpeedOverrides = new WeakMap<HTMLElement, number>();\n    private unsubScreensaverShown?: () => void;\n    private unsubScreensaverHidden?: () => void;\n    private unbindVisibility?: () => void;\n    private pausedByScreensaver = false;\n    private speedBeforeScreensaver = 1;\n    private animationPolicy = new AnimationPolicy();\n\n    constructor(container: HTMLElement, options: FloatingImagesManagerOptionsInterface = {}) {\n        this.container = container;\n        this.debug = options.debug ?? false;\n        this.hoverBehavior = options.hoverBehavior ?? 'none';\n        this.hoverSlowMultiplier = options.hoverSlowMultiplier ?? 0.2;\n        this.tapToFreeze = options.tapToFreeze ?? true;\n        this.pauseOnScreensaver = options.pauseOnScreensaver ?? false;\n\n        this.performanceMonitor = new PerformanceMonitor();\n        const perfSettings = this.performanceMonitor.getRecommendedSettings();\n        this.maxImages = options.maxImages ?? perfSettings.maxImages;\n\n        this.intersectionObserver = new IntersectionObserver(entries => {\n            const entry = entries[0];\n            if (!entry) return;\n            this.isInViewport = !!entry.isIntersecting;\n        }, { threshold: 0 });\n        this.intersectionObserver.observe(this.container);\n\n        this.setupResizeHandling();\n        this.setupScreensaverHandling();\n        this.imageLoader = new AsyncImageLoader(this.container);\n        this.updateContainerDimensions();\n\n        this.animateCallback = () => this.animate();\n\n        // Only add callback if not already in AnimationLoop\n        if (!animationLoop.has(this.animateCallback)) {\n            animationLoop.add(this.animateCallback);\n        }\n\n        this.initializeImages();\n        this.log('info', 'FloatingImagesManager initialized', {\n            container: this.container,\n            maxImages: this.maxImages\n        });\n    }\n\n    private log(level: 'debug' | 'info' | 'warn' | 'error', message: string, data?: unknown) {\n        if (!this.debug && level === 'debug') return;\n\n        const payload: LogPayload = { scope: 'FloatingImagesManager', level, message, data, time: Date.now() };\n        eventBus.emit(EVENTS.FLOATING_IMAGES_LOG, { level, message, data });\n        eventBus.emit(EVENTS.LOG, payload);\n\n        if (this.debug) {\n            const consoleMethodMap: Record<'debug' | 'info' | 'warn' | 'error', keyof Console> = {\n                debug: 'debug',\n                info: 'info',\n                warn: 'warn',\n                error: 'error',\n            };\n            const method = consoleMethodMap[level] ?? 'log';\n            (console as any)[method](`[FloatingImagesManager] [${level.toUpperCase()}]`, message, data);\n        }\n    }\n\n    private setupResizeHandling() {\n        this.unsubscribeWindow = resizeManager.onWindow(() => this.handleResize());\n        this.unsubscribeElement = resizeManager.onElement(this.container, () => this.handleResize());\n    }\n\n    private setupScreensaverHandling() {\n        if (!this.pauseOnScreensaver) return;\n\n        this.unsubScreensaverShown = eventBus.on(EVENTS.SCREENSAVER_SHOWN, () => {\n            if (this.pausedByScreensaver) return;\n            this.speedBeforeScreensaver = this.speedMultiplier;\n            this.speedMultiplier = 0;\n            this.pausedByScreensaver = true;\n            this.animationPolicy.set('screensaver', true);\n            this.log('debug', 'Paused due to screensaver');\n        });\n\n        this.unsubScreensaverHidden = eventBus.on(EVENTS.SCREENSAVER_HIDDEN, () => {\n            if (!this.pausedByScreensaver) return;\n            this.speedMultiplier = this.speedBeforeScreensaver;\n            this.pausedByScreensaver = false;\n            this.animationPolicy.set('screensaver', false);\n            this.log('debug', 'Resumed after screensaver');\n        });\n\n        const onVisibilityChange = () => {\n            this.animationPolicy.set('hidden', document.visibilityState === 'hidden');\n        };\n        document.addEventListener('visibilitychange', onVisibilityChange);\n        this.unbindVisibility = () => document.removeEventListener('visibilitychange', onVisibilityChange);\n    }\n\n    private updateContainerDimensions() {\n        if (!this.container.isConnected) {\n            this.containerWidth = 0;\n            this.containerHeight = 0;\n            this.log('warn', 'Container is not in the DOM, dimensions set to 0');\n            return;\n        }\n        const dims = resizeManager.getElement(this.container);\n        this.containerWidth = dims.width;\n        this.containerHeight = dims.height;\n    }\n\n    private async initializeImages() {\n        try {\n            const imgElements = await this.imageLoader.waitForImagesToLoad('.floating-image');\n            const dims = { width: this.containerWidth, height: this.containerHeight };\n            // if destroyed while awaiting, avoid adding images\n            imgElements.slice(0, this.maxImages).forEach(el => {\n                if (this._destroyed) return;\n                this.addExistingImage(el, dims);\n            });\n            this.log('info', 'Images initialized', { count: this.images.length });\n        } catch (err) {\n            this.log('error', 'Failed to initialize images', err);\n        }\n    }\n\n    private addExistingImage(el: HTMLElement, dims: ContainerDimensionsInterface) {\n        if (this.images.length >= this.maxImages) return;\n        const floatingImage = new FloatingImage(el, dims, { debug: this.debug });\n        this.images.push(floatingImage);\n        this.bindImageInteraction(el);\n    }\n\n    private handleResize = debounce(() => {\n        try {\n            if (this._destroyed) return;\n            if (!this.container.isConnected) {\n                this.log('warn', 'Resize event ignored, container not in DOM');\n                return;\n            }\n            this.updateContainerDimensions();\n            const dims = { width: this.containerWidth, height: this.containerHeight };\n            this.images.forEach(img => {\n                img.updateSize();\n                img.clampPosition(dims);\n                img.updatePosition();\n            });\n            this.log('debug', 'Container resized', dims);\n        } catch (error) {\n            this.log('error', 'Error during handleResize', error);\n        }\n    }, 200);\n\n    private animate() {\n        if (this._destroyed) return;\n\n        if (!this.isInViewport || this.speedMultiplier === 0 || this.animationPolicy.isPaused()) return;\n\n        const skipFrame = this.performanceMonitor.update();\n        if (skipFrame) return;\n\n        const multiplier = this.speedMultiplier;\n        const dims = { width: this.containerWidth, height: this.containerHeight };\n\n        this.images = this.images.filter(img => {\n            const el = img.getElement();\n            const imageMultiplier = el ? (this.imageSpeedOverrides.get(el) ?? multiplier) : multiplier;\n            if (imageMultiplier <= 0) {\n                return img.updatePosition();\n            }\n            return img.update(imageMultiplier, dims);\n        });\n    }\n\n    public resetAllImagePositions() {\n        const dims = { width: this.containerWidth, height: this.containerHeight };\n        this.images.forEach(img => img.resetPosition(dims));\n        this.log('debug', 'All image positions reset', dims);\n    }\n\n    public reinitializeImages() {\n        try {\n            if (this._destroyed) return;\n            if (!this.container.isConnected) {\n                this.log('warn', 'reinitializeImages: container not in DOM, skipping');\n                return;\n            }\n\n            this.images.forEach(img => img.destroy());\n            this.images.length = 0;\n            this.unbindImageInteractions();\n\n            const dims = { width: this.containerWidth, height: this.containerHeight };\n            const imgElements = Array.from(this.container.querySelectorAll<HTMLElement>('.floating-image'))\n                .slice(0, this.maxImages);\n\n            imgElements.forEach(el => {\n                const floatingImage = new FloatingImage(el, dims, { debug: this.debug });\n                this.images.push(floatingImage);\n                this.bindImageInteraction(el);\n            });\n\n            this.log('info', 'Images reinitialized', { count: this.images.length });\n        } catch (error) {\n            this.log('error', 'Error during reinitializeImages', error);\n        }\n    }\n\n    destroy() {\n        if (this._destroyed) return;\n\n        this._destroyed = true;\n\n        if (animationLoop.has(this.animateCallback)) {\n            animationLoop.remove(this.animateCallback);\n        }\n\n        this.unsubscribeWindow?.();\n        this.unsubscribeElement?.();\n        this.unsubScreensaverShown?.();\n        this.unsubScreensaverHidden?.();\n        this.unbindVisibility?.();\n        // clear unsubscribe refs to avoid keeping closures alive\n        this.unsubscribeWindow = undefined;\n        this.unsubscribeElement = undefined;\n        this.unsubScreensaverShown = undefined;\n        this.unsubScreensaverHidden = undefined;\n        this.unbindVisibility = undefined;\n\n        this.intersectionObserver.disconnect();\n        this.unbindImageInteractions();\n        this.images.forEach(img => img.destroy());\n        this.images.length = 0;\n        this.imageLoader.destroy();\n\n        // reset container dims\n        this.containerWidth = 0;\n        this.containerHeight = 0;\n\n        this.log('info', 'FloatingImagesManager destroyed');\n    }\n\n    private bindImageInteraction(el: HTMLElement): void {\n        const hoverEnabled = this.hoverBehavior !== 'none';\n        const touchEnabled = this.tapToFreeze;\n        if (!hoverEnabled && !touchEnabled) return;\n\n        const onPointerEnter = () => {\n            if (this.hoverBehavior === 'none') return;\n            if (this.frozenElements.has(el)) return;\n            if (this.hoverBehavior === 'stop') {\n                this.imageSpeedOverrides.set(el, 0);\n                return;\n            }\n            this.imageSpeedOverrides.set(el, this.hoverSlowMultiplier);\n        };\n\n        const onPointerLeave = () => {\n            if (this.frozenElements.has(el)) return;\n            this.imageSpeedOverrides.delete(el);\n        };\n\n        const onPointerUp = (event: PointerEvent) => {\n            if (!this.tapToFreeze || event.pointerType !== 'touch') return;\n            if (this.frozenElements.has(el)) {\n                this.frozenElements.delete(el);\n                this.imageSpeedOverrides.delete(el);\n                return;\n            }\n            this.frozenElements.add(el);\n            this.imageSpeedOverrides.set(el, 0);\n        };\n\n        el.addEventListener('pointerenter', onPointerEnter);\n        el.addEventListener('pointerleave', onPointerLeave);\n        el.addEventListener('pointerup', onPointerUp);\n\n        this.interactionCleanups.push(() => {\n            el.removeEventListener('pointerenter', onPointerEnter);\n            el.removeEventListener('pointerleave', onPointerLeave);\n            el.removeEventListener('pointerup', onPointerUp);\n            this.imageSpeedOverrides.delete(el);\n        });\n    }\n\n    private unbindImageInteractions(): void {\n        this.interactionCleanups.forEach(unsub => unsub());\n        this.interactionCleanups = [];\n        this.frozenElements = new WeakSet<HTMLElement>();\n        this.imageSpeedOverrides = new WeakMap<HTMLElement, number>();\n    }\n}\n", "// src/spaceface/features/Screensaver/ScreensaverController.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport { eventBus } from \"../../bin/EventBus.js\";\nimport { EventBinder } from \"../../bin/EventBinder.js\";\nimport { InactivityWatcher } from \"../../bin/InactivityWatcher.js\";\nimport { PartialFetcher } from \"../../bin/PartialFetcher.js\";\nimport { FloatingImagesManager } from \"../FloatingImages/FloatingImagesManager.js\";\nimport type { LogPayload } from \"../../types/bin.js\";\nimport { EVENTS } from \"../../types/events.js\";\n\nimport type {\n  ScreensaverControllerOptionsInterface,\n  FloatingImagesManagerInterface\n} from \"../../types/features.js\";\n\nexport class ScreensaverController {\n  private static readonly STATES = {\n    IDLE: 'idle',\n    LOADING: 'loading',\n    VISIBLE: 'visible',\n    HIDING: 'hiding',\n    DESTROYED: 'destroyed',\n  } as const;\n\n  private readonly partialUrl: string;\n  private readonly targetSelector: string;\n  private readonly inactivityDelay: number;\n  private readonly debug: boolean;\n  private readonly onError?: (message: string, error: unknown) => void;\n\n  private screensaverManager: FloatingImagesManagerInterface | null = null;\n  private watcher: InactivityWatcher | null = null;\n  private _destroyed = false;\n  private eventBinder: EventBinder;\n  private _partialLoaded = false;\n  private partialFetcher: typeof PartialFetcher;\n  // avoid duplicate concurrent partial loads\n  private _loadPromise?: Promise<void>;\n  private _hideTimeout: number | null = null;\n  private _bound = false;\n  private state: typeof ScreensaverController.STATES[keyof typeof ScreensaverController.STATES] = ScreensaverController.STATES.IDLE;\n\n  private _onInactivity: () => void;\n  private _onActivity: () => void;\n\n  constructor(\n    options: ScreensaverControllerOptionsInterface & {\n      watcher?: InactivityWatcher;\n      partialFetcher?: typeof PartialFetcher;\n      debug?: boolean;\n    }\n  ) {\n    this.partialUrl = options.partialUrl;\n    this.targetSelector = options.targetSelector;\n    this.inactivityDelay = options.inactivityDelay ?? 12000;\n    this.debug = !!options.debug;\n\n    this.watcher = options.watcher ?? null;\n    this.partialFetcher = options.partialFetcher ?? PartialFetcher;\n    this.onError = options.onError;\n\n    this.eventBinder = new EventBinder(this.debug);\n    this._onInactivity = this.showScreensaver.bind(this);\n    this._onActivity = this.hideScreensaver.bind(this);\n\n    this.log('info', 'ScreensaverController initialized', {\n      partialUrl: this.partialUrl,\n      targetSelector: this.targetSelector,\n      inactivityDelay: this.inactivityDelay\n    });\n  }\n\n  /** Centralized logging with debug and level support */\n  private log(\n    level: 'debug' | 'info' | 'warn' | 'error',\n    message: string,\n    data?: unknown\n  ) {\n    if (!this.debug && level === 'debug') return;\n\n    const payload: LogPayload = { scope: 'ScreensaverController', level, message, data, time: Date.now() };\n    eventBus.emit(EVENTS.SCREENSAVER_LOG, { level, message, data });\n    eventBus.emit(EVENTS.LOG, payload);\n\n    if (this.debug) {\n      const consoleMethodMap: Record<'debug' | 'info' | 'warn' | 'error', keyof Console> = {\n        debug: 'debug',\n        info: 'info',\n        warn: 'warn',\n        error: 'error'\n      };\n      const method = consoleMethodMap[level] ?? 'log';\n      (console as any)[method](`[ScreensaverController] [${level.toUpperCase()}]`, message, data);\n    }\n  }\n\n  async init(): Promise<void> {\n    if (this._destroyed) return;\n    if (this._bound) return;\n\n    try {\n      if (!this.watcher) {\n        this.watcher = InactivityWatcher.getInstance({\n          inactivityDelay: this.inactivityDelay\n        });\n      }\n\n      this.eventBinder.bindBus(EVENTS.USER_INACTIVE, this._onInactivity);\n      this.eventBinder.bindBus(EVENTS.USER_ACTIVE, this._onActivity);\n      this._bound = true;\n\n      this.log('info', 'Bound user inactivity/active events');\n    } catch (error) {\n      this.handleError('Failed to initialize inactivity watcher', error);\n    }\n  }\n\n  async showScreensaver(): Promise<void> {\n    if (this._destroyed) return;\n    if (this.state === ScreensaverController.STATES.VISIBLE || this.state === ScreensaverController.STATES.LOADING) return;\n\n    try {\n      this.state = ScreensaverController.STATES.LOADING;\n      if (!this._partialLoaded) {\n        if (!this._loadPromise) {\n          this._loadPromise = this.partialFetcher\n            .load(this.partialUrl, this.targetSelector)\n            .then(() => { this._partialLoaded = true; })\n            .finally(() => { this._loadPromise = undefined; });\n        }\n        await this._loadPromise;\n      }\n\n      const container = document.querySelector<HTMLElement>(this.targetSelector);\n      if (!container) {\n        this.state = ScreensaverController.STATES.IDLE;\n        this.handleError(`Target selector \"${this.targetSelector}\" not found`, null);\n        return;\n      }\n\n      container.style.opacity = '0';\n      container.style.display = '';\n      void container.offsetWidth; // force reflow\n      container.style.transition = 'opacity 0.5s ease';\n      container.style.opacity = '1';\n\n      if (!this.screensaverManager) {\n        this.screensaverManager = new FloatingImagesManager(container, { debug: this.debug });\n      } else {\n        this.screensaverManager.destroy();\n        this.screensaverManager = new FloatingImagesManager(container, { debug: this.debug });\n      }\n\n      this.state = ScreensaverController.STATES.VISIBLE;\n      eventBus.emit(EVENTS.SCREENSAVER_SHOWN, { targetSelector: this.targetSelector });\n      this.log('info', 'Screensaver displayed');\n    } catch (error) {\n      this.state = ScreensaverController.STATES.IDLE;\n      this.handleError('Failed to load or show screensaver', error);\n    }\n  }\n\n  hideScreensaver(): void {\n    if (this._destroyed) return;\n    if (this.state === ScreensaverController.STATES.IDLE || this.state === ScreensaverController.STATES.HIDING) return;\n\n    try {\n      this.state = ScreensaverController.STATES.HIDING;\n      const container = document.querySelector<HTMLElement>(this.targetSelector);\n      if (container) {\n        container.style.transition = 'opacity 0.5s ease';\n        container.style.opacity = '0';\n        if (this._hideTimeout) {\n          clearTimeout(this._hideTimeout);\n        }\n        this._hideTimeout = window.setTimeout(() => {\n          container.style.display = 'none';\n          this.state = ScreensaverController.STATES.IDLE;\n          this._hideTimeout = null;\n        }, 500);\n      } else {\n        this.state = ScreensaverController.STATES.IDLE;\n      }\n\n      eventBus.emit(EVENTS.SCREENSAVER_HIDDEN, { targetSelector: this.targetSelector });\n      this.log('debug', 'Screensaver hidden');\n    } catch (error) {\n      this.state = ScreensaverController.STATES.IDLE;\n      this.handleError('Failed to hide screensaver', error);\n    }\n  }\n\n  destroy(): void {\n    if (this._destroyed) return;\n    this._destroyed = true;\n    this.state = ScreensaverController.STATES.DESTROYED;\n\n    this.hideScreensaver();\n    try { this.screensaverManager?.destroy(); } catch (err) { this.log('warn', 'screensaverManager.destroy() failed', err); }\n    this.eventBinder.unbindAll();\n    this._partialLoaded = false;\n    if (this._hideTimeout) {\n      clearTimeout(this._hideTimeout);\n      this._hideTimeout = null;\n    }\n    // clear pending load ref to avoid holding Promise after destroy\n    this._loadPromise = undefined;\n    this._bound = false;\n\n    this.log('info', 'ScreensaverController destroyed');\n  }\n\n  private handleError(message: string, error: unknown): void {\n    eventBus.emit(EVENTS.SCREENSAVER_ERROR, { message, error });\n    this.onError?.(message, error);\n    this.log('error', message, error);\n  }\n}\n", "// src/spaceface/system/bin/DomReadyPromise.ts\n\nexport const VERSION = '2.0.0' as const;\n\nimport { WaitForElementOptions } from '../types/bin.js';\n\n/**\n * Utility class for DOM readiness and waiting for elements to appear.\n * Provides:\n * - A promise for when the DOM is ready (`DOMContentLoaded`).\n * - A helper to wait until specific elements are present in the DOM.\n */\nexport class DomReadyPromise {\n    /** Cached promise that resolves once the DOM is ready */\n    static #readyPromise: Promise<void> | null = null;\n\n    /**\n     * Returns a promise that resolves when the DOM is fully loaded.\n     */\n    static ready(): Promise<void> {\n        if (!this.#readyPromise) {\n            this.#readyPromise = document.readyState !== 'loading'\n                ? Promise.resolve()\n                : new Promise<void>(resolve => {\n                    document.addEventListener('DOMContentLoaded', () => resolve(), { once: true });\n                });\n        }\n        return this.#readyPromise;\n    }\n\n    /**\n     * Waits for one or more DOM elements to appear in the document.\n     */\n    static waitForElement<T extends Element>(\n        selectors: string | string[],\n        options: WaitForElementOptions = {}\n    ): Promise<T | T[]> {\n        const { timeout = 5000, root = document, signal } = options;\n        if (timeout <= 0) {\n            return Promise.reject(new TypeError('Timeout must be greater than 0'));\n        }\n\n        const selectorList = Array.isArray(selectors) ? selectors : [selectors];\n        const foundElements: Map<string, T> = new Map();\n\n        return new Promise((resolve, reject) => {\n            let timeoutId: number | undefined;\n            const checkForElements = () => {\n                for (const selector of selectorList) {\n                    if (!foundElements.has(selector)) {\n                        const el = root.querySelector<T>(selector);\n                        if (el) foundElements.set(selector, el);\n                    }\n                }\n                if (foundElements.size === selectorList.length) {\n                    cleanup();\n                    resolve(selectorList.length === 1\n                        ? foundElements.get(selectorList[0])!\n                        : Array.from(foundElements.values()));\n                }\n            };\n\n            const observer = new MutationObserver(checkForElements);\n\n            const cleanup = () => {\n                observer.disconnect();\n                if (timeoutId !== undefined) clearTimeout(timeoutId);\n                signal?.removeEventListener('abort', onAbort);\n            };\n\n            const onAbort = () => {\n                cleanup();\n                reject(new DOMException('waitForElement aborted', 'AbortError'));\n            };\n\n            if (signal?.aborted) return onAbort();\n            signal?.addEventListener('abort', onAbort, { once: true });\n\n            observer.observe(root, { childList: true, subtree: true });\n            // Check immediately in case elements already exist\n            checkForElements();\n\n            timeoutId = window.setTimeout(() => {\n                cleanup();\n                const missing = selectorList.filter(s => !foundElements.has(s));\n                reject(new DOMException(\n                    `Element(s) \"${missing.join(', ')}\" not found within ${timeout}ms in root: ${root.nodeName}`,\n                    'TimeoutError'\n                ));\n            }, timeout);\n        });\n    }\n}\n", "// src/spaceface/app/bin/symlinks.ts\n\nexport { DomReadyPromise } from \"../system/bin/DomReadyPromise.js\";\nexport { InactivityWatcher } from \"../system/bin/InactivityWatcher.js\";\nexport { eventBus } from \"../system/bin/EventBus.js\";\nexport { EventBinder } from \"../system/bin/EventBinder.js\";\nexport { EventWatcher } from \"../system/bin/EventWatcher.js\";\nexport { PartialFetcher } from \"../system/bin/PartialFetcher.js\";\nexport { PartialLoader } from \"../system/bin/PartialLoader.js\";\nexport { generateId } from \"../system/bin/generateId.js\";\n\nexport type { FloatingImagesManagerInterface } from '../system/types/features.js';\n", "// src/spaceface/system/bin/generateId.ts\n\nexport const VERSION = '2.0.0' as const;\n\n/**\n * Generates a unique ID string with an optional prefix and length.\n *\n * @param prefix - The prefix for the ID (default: 'id').\n * @param length - The length of the random portion of the ID (default: 9).\n * @param useCrypto - Whether to use cryptographically secure random values (default: false).\n * @returns A unique ID string.\n */\nexport function generateId(prefix: string = 'id', length: number = 9, useCrypto: boolean = false): string {\n  if (!Number.isInteger(length) || length <= 0) {\n    throw new Error('Length must be a positive integer.');\n  }\n\n  const randomString = useCrypto\n    ? Array.from(crypto.getRandomValues(new Uint8Array(length)))\n        .map((byte) => (byte % 36).toString(36))\n        .join('')\n    : Math.random().toString(36).slice(2, 2 + length);\n\n  return `${prefix}-${randomString}`;\n}\n", "// src/spaceface/app/bin/spaceface.core.ts\n\nimport {\n    generateId,\n    eventBus,\n    DomReadyPromise,\n    InactivityWatcher,\n    FloatingImagesManagerInterface\n} from './symlink.js';\nimport type { LogPayload } from '../system/types/bin.js';\nimport { EVENTS } from '../system/types/events.js';\nimport type {\n    AppConfigOptions,\n    AppRuntimeConfig,\n    FeatureModuleMap,\n    ManagedFeatureLifecycle,\n    PartialLoaderFeatureConfig,\n    SlideplayerFeatureConfig,\n    ScreensaverFeatureConfig,\n    FloatingImagesFeatureConfig,\n    SlidePlayerInstance,\n    ScreensaverControllerInstance,\n    PartialLoaderInstance,\n} from './types.js';\n\nexport class AppConfig {\n    public config: AppRuntimeConfig;\n\n    constructor(options: AppConfigOptions = {}) {\n        this.config = {\n            hostname: options.hostname ?? window.location.hostname,\n            production: options.production ?? (\n                window.location.hostname !== 'localhost' &&\n                !window.location.hostname.includes('127.0.0.1')\n            ),\n            features: options.features ?? {},\n            ...options,\n        };\n    }\n}\n\nexport class SpacefaceCore {\n    static EVENT_LOG = EVENTS.LOG;\n    static EVENT_TELEMETRY = EVENTS.TELEMETRY;\n\n    public appConfig: AppConfig;\n    public debug: boolean;\n    public pageType: string;\n    public startTime: number;\n\n    private featureModules: { [K in keyof FeatureModuleMap]: () => Promise<FeatureModuleMap[K]> };\n    private featureCache = new Map<keyof FeatureModuleMap, FeatureModuleMap[keyof FeatureModuleMap] | null>();\n    private inactivityWatcher: InactivityWatcher | null = null;\n    private screensaverController: ScreensaverControllerInstance | null = null;\n    private slideshows: SlidePlayerInstance[] = [];\n    private floatingImagesManagers: FloatingImagesManagerInterface[] = [];\n    private _partialUnsub?: () => void;\n    private _partialObserver?: { disconnect?: () => void };\n    private pjaxFeatures = new Map<string, { init: () => Promise<void> | void; when?: (pageType: string) => boolean }>();\n    private managedFeatures: ManagedFeatureLifecycle[] = [];\n    private onceFeatures: ManagedFeatureLifecycle[] = [];\n\n    constructor(options: AppConfigOptions = {}) {\n        this.appConfig = new AppConfig(options);\n        this.appConfig.config.features = this.normalizeFeaturesConfig(this.appConfig.config.features);\n        this.debug = !!this.appConfig.config.debug;\n        this.pageType = this.resolvePageType();\n        this.startTime = performance.now();\n\n        this.featureModules = {\n            partialLoader: () => import('../system/bin/PartialLoader.js'),\n            slideplayer: () => import('../system/features/SlidePlayer/SlidePlayer.js'),\n            screensaver: () => import('../system/features/Screensaver/ScreensaverController.js'),\n            floatingImages: () => import('../system/features/FloatingImages/FloatingImagesManager.js'),\n        };\n\n        if (!this.appConfig.config.features) {\n            this.log('warn', 'No features specified in config');\n        }\n\n        this.setupManagedFeatures();\n        this.setupOnceFeatures();\n    }\n\n    public log(level: 'debug' | 'info' | 'warn' | 'error', ...args: unknown[]): void {\n        if (!this.debug && level === 'debug') return;\n        const [first, ...rest] = args;\n        const message = typeof first === 'string' ? first : '';\n        const data = typeof first === 'string' ? (rest.length ? rest : undefined) : (args.length ? args : undefined);\n        const payload: LogPayload & { args: unknown[] } = {\n            level,\n            args,\n            scope: 'Spaceface',\n            message,\n            data,\n            time: Date.now(),\n        };\n        eventBus.emit(SpacefaceCore.EVENT_LOG, payload);\n        if (this.debug) {\n            console[level]?.(`[spaceface] [${level.toUpperCase()}]`, ...args);\n        }\n    }\n\n    private resolvePageType(): string {\n        const body = document.body;\n        if (body.dataset.page) return body.dataset.page;\n        const rawPath = window.location.pathname;\n        const path = rawPath.replace(/\\/+$/, '') || '/';\n        if (path === '/') return 'home';\n\n        const segment = path.split('/').filter(Boolean).pop() ?? 'default';\n        return segment\n            .replace(/\\.html$/i, '')\n            .replace(/^_+/, '')\n            || 'default';\n    }\n\n    private async loadFeatureModule<K extends keyof FeatureModuleMap>(name: K): Promise<FeatureModuleMap[K] | null> {\n        if (this.featureCache.has(name)) return this.featureCache.get(name) as FeatureModuleMap[K] | null;\n        try {\n            const module = await this.featureModules[name]?.();\n            if (!module) {\n                throw new Error(`Module \"${name}\" could not be loaded.`);\n            }\n            this.featureCache.set(name, module);\n            return module;\n        } catch (err) {\n            this.log('error', `Failed to load module \"${name}\"`, err);\n            this.featureCache.set(name, null);\n            return null;\n        }\n    }\n\n    public async initBase(): Promise<void> {\n        this.log('info', `App initialization started (Page: ${this.pageType})`);\n        document.documentElement.classList.add('js-enabled', `page-${this.pageType}`);\n        await DomReadyPromise.ready();\n        this.log('info', 'DOM ready');\n    }\n\n    public finishInit(): void {\n        const duration = (performance.now() - this.startTime).toFixed(2);\n        this.log('info', `App initialized in ${duration}ms`);\n        eventBus.emit(SpacefaceCore.EVENT_TELEMETRY, {\n            type: 'init:duration',\n            value: duration,\n            page: this.pageType,\n        });\n    }\n\n    public async initInactivityWatcher(): Promise<void> {\n        const start = performance.now();\n        const screensaver = this.appConfig.config.features.screensaver;\n        if (!screensaver || this.inactivityWatcher) {\n            this.emitFeatureTelemetry('inactivityWatcher', start, 'skipped');\n            return;\n        }\n        try {\n            this.inactivityWatcher = InactivityWatcher.getInstance({\n                inactivityDelay: screensaver.delay ?? 3000,\n            });\n            this.log('debug', `InactivityWatcher initialized with delay=${screensaver.delay ?? 3000}ms`);\n            this.emitFeatureTelemetry('inactivityWatcher', start, 'success');\n        } catch (error) {\n            this.emitFeatureTelemetry('inactivityWatcher', start, 'error', error);\n            throw error;\n        }\n    }\n\n    public async initSlidePlayer(): Promise<void> {\n        const start = performance.now();\n        const slideplayer: SlideplayerFeatureConfig | undefined = this.appConfig.config.features.slideplayer;\n        if (!slideplayer) {\n            this.emitFeatureTelemetry('slideplayer', start, 'skipped');\n            return;\n        }\n        try {\n            const module = await this.loadFeatureModule('slideplayer');\n            const SlidePlayer = module?.SlidePlayer;\n            if (!SlidePlayer) {\n                this.emitFeatureTelemetry('slideplayer', start, 'skipped');\n                return;\n            }\n            this.slideshows = Array.from(document.querySelectorAll<HTMLElement>('.slideshow-container')).map(node => {\n                const slideshow = new SlidePlayer(node, {\n                    interval: slideplayer.interval ?? 5000,\n                    includePicture: slideplayer.includePicture ?? false,\n                });\n                slideshow.ready?.then?.(() => {});\n                return slideshow;\n            });\n            this.log('info', `${this.slideshows.length} SlidePlayer instance(s) loaded`);\n            this.emitFeatureTelemetry('slideplayer', start, 'success');\n        } catch (error) {\n            this.emitFeatureTelemetry('slideplayer', start, 'error', error);\n            throw error;\n        }\n    }\n\n    public async initScreensaver(): Promise<void> {\n        const start = performance.now();\n        const screensaver: ScreensaverFeatureConfig | undefined = this.appConfig.config.features.screensaver;\n        if (!screensaver?.partialUrl) {\n            this.log('error', \"Screensaver configuration is missing or incomplete\");\n            this.emitFeatureTelemetry('screensaver', start, 'skipped');\n            return;\n        }\n        try {\n            const module = await this.loadFeatureModule('screensaver');\n            const ScreensaverController = module?.ScreensaverController;\n            if (!ScreensaverController) {\n                throw new Error('ScreensaverController module is unavailable.');\n            }\n            const id = generateId('screensaver', 9);\n            const container = Object.assign(document.createElement('div'), {\n                id,\n                style: 'position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 999; display: none;',\n            });\n            document.body.appendChild(container);\n            this.screensaverController = new ScreensaverController({\n                partialUrl: screensaver.partialUrl,\n                targetSelector: `#${id}`,\n                ...(screensaver.delay !== undefined && { inactivityDelay: screensaver.delay }),\n            });\n            await this.screensaverController?.init?.();\n            eventBus.emit(EVENTS.SCREENSAVER_INITIALIZED, id);\n            this.log('info', 'Screensaver initialized:', id);\n            this.emitFeatureTelemetry('screensaver', start, 'success');\n        } catch (error) {\n            this.log('error', 'Failed to initialize screensaver:', error);\n            this.emitFeatureTelemetry('screensaver', start, 'error', error);\n        }\n    }\n\n    public async initPartialLoader(): Promise<PartialLoaderInstance | null> {\n        const start = performance.now();\n        const config: PartialLoaderFeatureConfig | undefined = this.appConfig.config.features.partialLoader;\n        if (!config?.enabled) {\n            this.emitFeatureTelemetry('partialLoader', start, 'skipped');\n            return null;\n        }\n        try {\n            const module = await this.loadFeatureModule('partialLoader');\n            const PartialLoader = module?.PartialLoader;\n            if (!PartialLoader) {\n                this.emitFeatureTelemetry('partialLoader', start, 'skipped');\n                return null;\n            }\n            const loader = new PartialLoader({\n                debug: config.debug ?? this.debug,\n                baseUrl: config.baseUrl ?? '/',\n                cacheEnabled: config.cacheEnabled ?? true,\n                timeout: config.timeout,\n                retryAttempts: config.retryAttempts,\n            });\n            await loader.loadContainer(document);\n            const watchResult = loader.watch?.(document);\n            if (typeof watchResult === 'function') {\n                this._partialUnsub = watchResult;\n            } else if (watchResult) {\n                this._partialObserver = watchResult;\n            }\n            this.log('info', 'PartialLoader initialized');\n            this.emitFeatureTelemetry('partialLoader', start, 'success');\n            return loader;\n        } catch (error) {\n            this.emitFeatureTelemetry('partialLoader', start, 'error', error);\n            throw error;\n        }\n    }\n\n    public async initDomFeatures(): Promise<void> {\n        await this.runFeatureGraph(this.managedFeatures, 'init');\n    }\n\n    public async initOnceFeatures(): Promise<void> {\n        await this.runFeatureGraph(this.onceFeatures, 'init');\n        this.log('info', `Page features initialized for: ${this.pageType}`);\n    }\n\n    public registerPjaxFeature(\n        name: string,\n        init: () => Promise<void> | void,\n        when?: (pageType: string) => boolean\n    ): void {\n        if (this.pjaxFeatures.has(name)) return;\n        this.pjaxFeatures.set(name, { init, when });\n    }\n\n    public async handlePjaxComplete(): Promise<void> {\n        this.pageType = this.resolvePageType();\n        document.documentElement.classList.add(`page-${this.pageType}`);\n\n        await this.runFeatureGraph(this.managedFeatures, 'onRouteChange');\n\n        for (const { init, when } of this.pjaxFeatures.values()) {\n            if (when && !when(this.pageType)) continue;\n            await init();\n        }\n    }\n\n    public destroy(): void {\n        this._partialUnsub?.();\n        this._partialObserver?.disconnect?.();\n        this.managedFeatures.forEach(feature => feature.destroy());\n        this.onceFeatures.forEach(feature => feature.destroy());\n        this.featureCache.clear();\n        document.querySelector('[id^=\"screensaver\"]')?.remove();\n        this.log('info', 'Spaceface destroyed, all resources released.');\n    }\n\n    private emitFeatureTelemetry(\n        feature: string,\n        startTime: number,\n        status: 'success' | 'skipped' | 'error',\n        error?: unknown\n    ): void {\n        const duration = (performance.now() - startTime).toFixed(2);\n        eventBus.emit(SpacefaceCore.EVENT_TELEMETRY, {\n            type: 'feature:init',\n            feature,\n            status,\n            duration,\n            page: this.pageType,\n            error,\n        });\n    }\n\n    public async initFloatingImages(): Promise<void> {\n        const start = performance.now();\n        const floatingImages: FloatingImagesFeatureConfig | undefined = this.appConfig.config.features.floatingImages;\n        if (!floatingImages) {\n            this.emitFeatureTelemetry('floatingImages', start, 'skipped');\n            return;\n        }\n\n        try {\n            const module = await this.loadFeatureModule('floatingImages');\n            const FloatingImagesManager = module?.FloatingImagesManager;\n            if (!FloatingImagesManager) {\n                this.emitFeatureTelemetry('floatingImages', start, 'skipped');\n                return;\n            }\n\n            const selector = floatingImages.selector ?? '.floating-images-container';\n            const containers = Array.from(document.querySelectorAll<HTMLElement>(selector));\n            if (!containers.length) {\n                this.emitFeatureTelemetry('floatingImages', start, 'skipped');\n                return;\n            }\n\n            this.destroyFloatingImagesManagers();\n            const shouldPauseOnScreensaver =\n                floatingImages.pauseOnScreensaver ?? (this.pageType === 'floatingimages');\n            this.floatingImagesManagers = containers.map(container => {\n                return new FloatingImagesManager(container, {\n                    maxImages: floatingImages.maxImages,\n                    debug: floatingImages.debug ?? this.debug,\n                    hoverBehavior: floatingImages.hoverBehavior ?? 'none',\n                    hoverSlowMultiplier: floatingImages.hoverSlowMultiplier ?? 0.2,\n                    tapToFreeze: floatingImages.tapToFreeze ?? true,\n                    pauseOnScreensaver: shouldPauseOnScreensaver,\n                });\n            });\n\n            this.log('info', `${this.floatingImagesManagers.length} FloatingImages instance(s) loaded`);\n            this.emitFeatureTelemetry('floatingImages', start, 'success');\n        } catch (error) {\n            this.emitFeatureTelemetry('floatingImages', start, 'error', error);\n            throw error;\n        }\n    }\n\n    private destroyFloatingImagesManagers(): void {\n        this.floatingImagesManagers.forEach(manager => manager.destroy?.());\n        this.floatingImagesManagers = [];\n    }\n\n    private destroySlidePlayers(): void {\n        this.slideshows.forEach(slideshow => slideshow.destroy?.());\n        this.slideshows = [];\n    }\n\n    private setupManagedFeatures(): void {\n        this.managedFeatures = [\n            {\n                name: 'slideplayer',\n                dependsOn: [],\n                init: () => this.initSlidePlayer(),\n                onRouteChange: async () => {\n                    this.destroySlidePlayers();\n                    await this.initSlidePlayer();\n                },\n                destroy: () => this.destroySlidePlayers(),\n            },\n            {\n                name: 'floatingImages',\n                dependsOn: [],\n                init: () => this.initFloatingImages(),\n                onRouteChange: async () => {\n                    this.destroyFloatingImagesManagers();\n                    await this.initFloatingImages();\n                },\n                destroy: () => this.destroyFloatingImagesManagers(),\n            },\n        ];\n    }\n\n    private setupOnceFeatures(): void {\n        this.onceFeatures = [\n            {\n                name: 'inactivityWatcher',\n                dependsOn: [],\n                init: () => this.initInactivityWatcher(),\n                destroy: () => this.inactivityWatcher?.destroy?.(),\n            },\n            {\n                name: 'screensaver',\n                dependsOn: ['inactivityWatcher'],\n                init: () => this.initScreensaver(),\n                destroy: () => this.screensaverController?.destroy?.(),\n            },\n        ];\n    }\n\n    private async runFeatureGraph(\n        features: ManagedFeatureLifecycle[],\n        stage: 'init' | 'onRouteChange'\n    ): Promise<void> {\n        const pending = new Map(features.map(feature => [feature.name, feature]));\n        const completed = new Set<string>();\n        let guard = 0;\n\n        while (pending.size) {\n            guard++;\n            if (guard > features.length * 2) {\n                throw new Error('Feature dependency graph contains a cycle or unresolved dependency.');\n            }\n\n            let progressed = false;\n            for (const [name, feature] of Array.from(pending.entries())) {\n                const deps = feature.dependsOn ?? [];\n                if (!deps.every(dep => completed.has(dep))) continue;\n\n                if (stage === 'onRouteChange' && feature.onRouteChange) {\n                    await feature.onRouteChange(this.pageType);\n                } else {\n                    await feature.init();\n                }\n\n                pending.delete(name);\n                completed.add(name);\n                progressed = true;\n            }\n\n            if (!progressed) {\n                const unresolved = Array.from(pending.keys()).join(', ');\n                throw new Error(`Unresolved feature dependencies: ${unresolved}`);\n            }\n        }\n    }\n\n    public getFeatureSnapshot(): {\n        pageType: string;\n        managedFeatures: string[];\n        onceFeatures: string[];\n        activeSlidePlayers: number;\n        activeFloatingImagesManagers: number;\n        inactivityWatcherReady: boolean;\n        screensaverReady: boolean;\n        partialLoaderWatching: boolean;\n    } {\n        return {\n            pageType: this.pageType,\n            managedFeatures: this.managedFeatures.map(f => f.name),\n            onceFeatures: this.onceFeatures.map(f => f.name),\n            activeSlidePlayers: this.slideshows.length,\n            activeFloatingImagesManagers: this.floatingImagesManagers.length,\n            inactivityWatcherReady: !!this.inactivityWatcher,\n            screensaverReady: !!this.screensaverController,\n            partialLoaderWatching: !!(this._partialUnsub || this._partialObserver),\n        };\n    }\n\n    private normalizeFeaturesConfig(features: AppRuntimeConfig['features']): AppRuntimeConfig['features'] {\n        const normalized = { ...features };\n\n        const isPositiveNumber = (value: unknown) => typeof value === 'number' && Number.isFinite(value) && value > 0;\n\n        if (normalized.slideplayer) {\n            if (normalized.slideplayer.interval !== undefined && !isPositiveNumber(normalized.slideplayer.interval)) {\n                this.log('warn', 'Invalid slideplayer.interval; expected positive number. Falling back to default.');\n                delete normalized.slideplayer.interval;\n            }\n        }\n\n        if (normalized.screensaver) {\n            if (typeof normalized.screensaver.partialUrl !== 'string' || !normalized.screensaver.partialUrl.trim()) {\n                this.log('warn', 'Invalid screensaver.partialUrl; disabling screensaver feature.');\n                delete normalized.screensaver;\n            } else if (normalized.screensaver.delay !== undefined && !isPositiveNumber(normalized.screensaver.delay)) {\n                this.log('warn', 'Invalid screensaver.delay; removing delay override.');\n                delete normalized.screensaver.delay;\n            }\n        }\n\n        if (normalized.floatingImages) {\n            if (normalized.floatingImages.maxImages !== undefined && !isPositiveNumber(normalized.floatingImages.maxImages)) {\n                this.log('warn', 'Invalid floatingImages.maxImages; removing override.');\n                delete normalized.floatingImages.maxImages;\n            }\n            if (\n                normalized.floatingImages.hoverSlowMultiplier !== undefined &&\n                (typeof normalized.floatingImages.hoverSlowMultiplier !== 'number' || normalized.floatingImages.hoverSlowMultiplier < 0)\n            ) {\n                this.log('warn', 'Invalid floatingImages.hoverSlowMultiplier; removing override.');\n                delete normalized.floatingImages.hoverSlowMultiplier;\n            }\n            if (\n                normalized.floatingImages.selector !== undefined &&\n                typeof normalized.floatingImages.selector !== 'string'\n            ) {\n                this.log('warn', 'Invalid floatingImages.selector; removing override.');\n                delete normalized.floatingImages.selector;\n            }\n        }\n\n        if (normalized.partialLoader) {\n            if (normalized.partialLoader.timeout !== undefined && !isPositiveNumber(normalized.partialLoader.timeout)) {\n                this.log('warn', 'Invalid partialLoader.timeout; removing override.');\n                delete normalized.partialLoader.timeout;\n            }\n            if (normalized.partialLoader.retryAttempts !== undefined && !isPositiveNumber(normalized.partialLoader.retryAttempts)) {\n                this.log('warn', 'Invalid partialLoader.retryAttempts; removing override.');\n                delete normalized.partialLoader.retryAttempts;\n            }\n        }\n\n        return normalized;\n    }\n}\n", "// src/spaceface/app/bin/main.ts\n\nimport { eventBus } from './symlink.js';\nimport { SpacefaceCore } from './spaceface.core.js';\nimport type { SpacefaceFeaturesConfig } from './types.js';\n\nconst features = {\n    partialLoader: { enabled: true, debug: true, baseUrl: '/', cacheEnabled: true },\n    slideplayer: { interval: 5000, includePicture: false },\n    floatingImages: {\n        selector: '.floating-images-container',\n        maxImages: 24,\n        debug: false,\n        hoverBehavior: 'slow',\n        hoverSlowMultiplier: 0.2,\n        tapToFreeze: true,\n    },\n    screensaver: { delay: 4500, partialUrl: 'content/feature/screensaver/index.html' },\n} satisfies SpacefaceFeaturesConfig;\n\n// Initialize App (dev/learning)\nconst app = new SpacefaceCore({\n    features,\n});\n\napp.initBase().then(async () => {\n    await app.initPartialLoader();\n    await app.initDomFeatures();\n    await app.initOnceFeatures();\n    app.finishInit();\n});\n\n// Dev Event Logging\nconst isDev = ['localhost', '127.0.0.1'].some(host =>\n    window.location.hostname.includes(host),\n);\n\nif (isDev) {\n    eventBus.onAny((eventName: string, payload: any) => {\n        // Filter noisy debug logs while keeping functional events visible.\n        if (eventName === 'log:debug') return;\n        if (eventName === 'log' && payload?.level === 'debug') return;\n        const { level = 'log', args, ...otherDetails } = payload ?? {};\n        if (!payload) return console.log(`[spaceface onAny] Event: ${eventName} \u2013 no payload!`);\n        if (typeof payload === 'string') return console.log(`[spaceface onAny] Event: ${eventName} [LOG]`, payload);\n\n        const fullMessage = args ?? otherDetails ?? '(no details)';\n        const methodMap: Record<'debug' | 'info' | 'warn' | 'error' | 'log', keyof Console> = {\n            debug: 'debug',\n            info: 'info',\n            warn: 'warn',\n            error: 'error',\n            log: 'log',\n        };\n        const method = methodMap[level as keyof typeof methodMap] ?? 'log';\n        (console as any)[method](`[SPCFC *] Event: ${eventName} [${String(level).toUpperCase()}] \u2013`, fullMessage);\n    });\n}\n\nwindow.addEventListener('beforeunload', () => {\n    app.destroy();\n    app.log('info', 'App destroyed on beforeunload');\n});\n"],
  "mappings": "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",
  "names": ["message", "payload", "VERSION", "entry", "VERSION", "VERSION", "SlidePlayer", "ScreensaverController", "PartialLoader", "FloatingImagesManager", "features"]
}
